STK.register("pl.common.scrollToTop.index",function(a){return function(b,c){function k(){j();document.body.scrollIntoView();return false}function j(){if(g){var c=a.winSize().height-250;!!b&&a.setStyle(b,"top",c)}}function i(){if(d!=null){if((new Date).getTime()-d<500){clearTimeout(e);e=null}}d=(new Date).getTime();e=setTimeout(h,100)}function h(){var c=a.scrollPos();var d=c.top;var e,h;if(d>0){!!f&&a.setStyle(f,"display","");if(g){e=a.winSize().height;h=d+e-250;!!b&&a.setStyle(b,"top",h)}}else{!!f&&a.setStyle(f,"display","none")}}if(b==null){a.log("[pl.common.scrollToTop]");return{destroy:a.funcEmpty}}var d,e,f=a.sizzle('[node-type="scrollToTop"]',b)[0];var g=a.getStyle(b,"position")!="fixed";j();a.addEvent(window,"scroll",i);a.addEvent(f,"click",k);i();var l={destroy:function(){a.removeEvent(window,"scroll",i);a.removeEvent(k,"click",k)}};return l}});
STK.pageletM.register("pl.common.scrollToTop",function(a){var b=a.E("pl_common_scrollToTop");if(b){return a.pl.common.scrollToTop.index(b)}});
STK.register("lib.kit.extra.language",function(a){window.$LANG||(window.$LANG={});var b=function(a,b){var c=[];for(var d=2,e=arguments.length;d<e;d+=1){c.push(arguments[d])}return a.replace(/#L\{((.*?)(?:[^\\]))\}/ig,function(){var a=arguments[1];var d;if(b&&b[a]!==undefined){d=b[a]}else{d=a}if(c.length){d=d.replace(/(\%s)/ig,function(){var a=c.shift();if(a!==undefined){return a}else{return arguments[0]}})}return d})};return function(a){var c=[].splice.call(arguments,1,arguments.length);var d=[a,$LANG].concat(c);var e=b.apply(this,d);return e}});
STK.register("common.channel.listener",function(a){var b={};var c={};c.define=function(c,d){if(b[c]!=null){throw"common.channel.listener.define: 频道已被占用"}b[c]=d;var e={};e.register=function(d,e){if(b[c]==null){throw"common.channel.listener.define: 频道未定义"}a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null){throw"common.channel.listener.define: 频道未定义"}a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("common.channel.searchHistory",function(a){var b=["on","off","add","del","clear"];return a.common.channel.listener.define("common.channel.searchHistory",b)});
STK.register("common.filter.getConfig",function(a){return{s_search:function(b){var c="",d=[];if(!b){return c}c=decodeURIComponent(b);if(c.indexOf("+")>-1){c=c.split("+");a.core.arr.foreach(c,function(a,b){d.push(decodeURIComponent(a))});c=d.join(" ")}else{c=decodeURIComponent(decodeURIComponent(b))}return c},htmlspecialchars:function b(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/"/g,"&quot;");a=a.replace(/'/g,"&#039;");return a}}});
STK.register("pl.history.searchHistory",function(a){var b="|@|",c="historyStat",d=a.common.channel.searchHistory,e="on",f="off",g="add",h="del",i="clear",j=false;var k=a.lib.kit.extra.language;return function(e,f){var l={};var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=k("#L{搜索历史}"),J=k("#L{清除}"),K=k("#L{暂无搜索记录}"),L,M=true;var N={};var O='<span class="W_arrow">&laquo;</span>';var P='<span class="W_arrow">&raquo;</span>';var Q={mDEL:function(b){r=b.el;r.parentNode.style.display="none";S.del({skey:r.parentNode.getElementsByTagName("A")[0].getAttribute("title")});a.core.evt.stopEvent()},mOver:function(a){},mOut:function(b){a.core.dom.removeClassName(b.el,"cur")},hSwitch:function(){var b,d;if(s=="hide"){b=O;s="show";d=u}else{b=P;s="hide";d=v}var f=a.core.ani.tween(m.menu,{end:function(){a.sizzle('[node-type="history_title"]',e)[0].innerHTML=I+b;a.core.util.storage.set(c,s)},duration:300,animationType:"linear"});f.play({height:d})},clear:function(){S.clear()}};var R={};var S={add:function(){var c=arguments[0].skey;if(!a.trim(c)){return}y=a.core.util.storage.get(f.sType);if(y=="null"||!y){a.core.util.storage.set(f.sType,b+c+b)}else{if(y.indexOf(b)!=0){y=b+y}if(y.lastIndexOf(b)!=y.length-b.length){y=y+b}y=y.substring(b.length,y.lastIndexOf(b));z=y.split(b);if(a.core.arr.inArray(c,z)){var d=a.core.arr.indexOf(c,z);delete z[d];z=a.core.arr.clear(z)}else{if(z.length>9){z.pop(z[z.length])}}z.unshift(c);y=b+z.join(b)+b;a.core.util.storage.set(f.sType,y)}U()},del:function(){var c=arguments[0].skey;if(!c){throw"[del]Lack of keyword -> path : comp.searchHistory"}y=a.core.util.storage.get(f.sType);c=c.replace(/&amplt;/g,"&lt;").replace(/&ampgt;/g,"&gt;").replace(/&ampquot;/g,"&quot;");if(y=="null"||!y){return;throw"[del]Not in record -> path : comp.searchHistory"}else{if(y.indexOf(c)<0){throw"[del]Not in record -> path : comp.searchHistory"}else{if(b.length*2+c.length==y.length){y="null"}else{y=y.replace(b+c+b,b)}}a.core.util.storage.set(f.sType,y)}U()},clear:function(){a.core.util.storage.set(f.sType,"null");U()}};var T=function(){a.core.str.leftB=function(b,c){var d=b.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");var e=c;for(var f=0,g=d.length;f<g;f++){var h=d.substr(f);if(h.substr(0,4)=="&gt;"||h.substr(0,4)=="&lt;"){e+=3}}b=b.slice(0,d.slice(0,e).replace(/\*\*/g," ").replace(/\*/g,"").length);if(a.core.str.bLength(b)>e)b=b.slice(0,b.length-1);return b};y=a.core.util.storage.get(f.sType);F=f.sType;B=function(a){var b;switch(F){case"weibo":G="/weibo?q="+encodeURIComponent(a)+"&Refer=STopic_history";break;case"user":G="/user?q="+encodeURIComponent(a)+"&Refer=SUer_history";break;case"video":G="/video?q="+encodeURIComponent(a)+"&Refer=SVideo_history";break;case"topic":G="/topic?q="+encodeURIComponent(a)+"&Refer=Sq_history";break;case"related":G="/related?q="+encodeURIComponent(a)+"&Refer=SRelated_history";break;case"pic":G="/pic?q="+encodeURIComponent(a)+"&Refer=Spic_history";break;case"article":G="/article?q="+encodeURIComponent(a)+"&Refer=Sarticle_history";break;case"hot":G="/hot?q="+encodeURIComponent(a)+"&Refer=Shot_history";break;case"realtime":G="/realtime?q="+encodeURIComponent(a)+"&Refer=Srealtime_history";break;default:G="/weibo?q="+encodeURIComponent(a)+"&Refer=STopic_history";break}return G};if(y=="null"||!y){A=['<div class="card card-history"><div class="card-head"><a href="javascript:void(0);" class="s-fr s-btn-c s-mt7" node-type="clearHistory" suda-data="key=tblog_search_'+$CONFIG["pageid"]+"&value="+$CONFIG["pageid"]+'_history_clear">清除</a><h4 class="title">'+I+'</h4></div><div class="card-content s-pg10"><p>'+K+"</p></div></div>"];L=true}else{L=false;if(!s){s=a.core.util.storage.get(c);if(s=="null"||!s){s="hidden"}}if(s=="show"){curstate=O}else{curstate=P}y=y.substring(b.length,y.lastIndexOf(b));z=y.split(b);A=['<div class="card card-history"><div class="card-head"><a href="javascript:void(0);" class="s-fr s-btn-c s-mt7" node-type="clearHistory" suda-data="key=tblog_search_'+$CONFIG["pageid"]+"&value="+$CONFIG["pageid"]+'_history_clear">清除</a><h4 class="title">'+I+'</h4></div><div class="card-content s-pg10"><ul node-type="searchHistory">'];for(var d=0,e=z.length;d<e;d++){if(z[d]){var g=z[d];if(g.indexOf("&lt;")>-1&&g.indexOf("&gt;")>-1){var h=g.replace(/&lt;/g,"&amplt;").replace(/&gt;/g,"&ampgt;").replace(/&quot;/g,"&ampquot;")}else{g=a.decodeHTML(z[d]);var h=g.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")}A[A.length]='<li action-type="history"><a class="txt" suda-data="key=tblog_search_'+$CONFIG["pageid"]+"&value="+$CONFIG["pageid"]+'_history" title="'+h+'" href="'+B(g)+'">'+a.core.str.leftB(h,40)+'</a><a href="javascript:void(0)" class="del" action-type="remove"><i class="wbicon">X</i></a></li>'}}A[A.length]="</ul></div>"}return A.join("")};var U=function(){V();W();X();Y();Z();_()};var V=function(){if(!e)throw"[pl_searchHistory] : missing  -> path : pl.history.searchHistory";C=function(a,b){var c;for(c in b){a[c]=b[c]}return a};f=C(f,{html:T()})};var W=function(){if(f.html){e.innerHTML=f.html}m={menu:a.core.dom.sizzle('[node-type="searchHistory"]',e)[0],clear:a.core.dom.sizzle('[node-type="clearHistory"]',e)[0]}};var X=function(){};var Y=function(){if(M){var b=a.core.evt.delegatedEvent(e);b.add("history","mouseover",Q.mOver);b.add("history","mouseout",Q.mOut);b.add("remove","click",Q.mDEL);M=false}a.core.evt.addEvent(m.history_title,"click",Q.hSwitch);a.core.evt.addEvent(m.clear,"click",Q.clear)};var Z=function(){};var _=function(){if(j){return}d.register(g,S.add);d.register(h,S.del);d.register(i,S.clear);j=true};var ba=function(){if(m.switchDom){a.core.evt.removeEvent(m.switchDom,"click",Q.hSwitch)}a.core.evt.removeEvent(m.clear,"click",Q.clear)};U();setTimeout(function(){S.add({skey:decodeURIComponent($CONFIG["s_search"])})},1e3);l.destroy=ba;return l}});
STK.pageletM.register("pl.history.index",function(a){var b=a.E("pl_history_index");if(!window.$CONFIG){window.$CONFIG={}}if(!b){return}var c=a.pl.history.searchHistory(b,{sType:$CONFIG.pageid?$CONFIG.pageid=="live"?"weibo":$CONFIG.pageid:"weibo"});return c});
STK.register("lib.kit.dom.parseDOM",function(a){return function(a){for(var b in a){if(a[b]&&a[b].length==1){a[b]=a[b][0]}}return a}});
STK.register("common.form.enterSubmit",function($){return function(options){var extend;extend=function(a,b){var c;for(c in b){a[c]=b[c]}return a};options=extend({parent:document},options);var _p=$.E(options.parent);var _checkEnter=function(){var _e=$.core.evt.getEvent();var _k=_e.keyCode;var _act=options.action||null;if(_k===13&&_act){try{if(typeof _act==="string"){eval("("+_act+")();")}else if(typeof _act==="function"){_act()}}catch(e){}}};if(_p){var els=_p.getElementsByTagName("input");for(var i=0,l=els.length;i<l;i++){var cur=els[i];var _t=cur.getAttribute("type").toLowerCase();if(_t==="text"||_t==="password"||_t==="checkbox"){if(cur.getAttribute("passenter")==="1"){continue}$.core.evt.addEvent(cur,"keydown",_checkEnter)}}}}});
STK.register("common.form.valueChange",function(a){var b={27:"esc",9:"tab",13:"enter",145:"scrolllock",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",17:"ctrl",16:"shift"};var c,d;return function(e,f){var g={delay:0,callback:a.core.func.empty};var h;f=a.parseParam(g,f);c=a.core.str.trim(e.value);var i=function(a){if(b[a]){return true}else{return false}};var j=function(){if(h){clearTimeout(h)}var b=a.core.evt.getEvent();var g=b.keyCode;d=a.core.str.trim(e.value);if(!i(g)&&d!=c){h=setTimeout(function(){f.callback();c=d;h=null},f.delay)}};a.core.evt.addEvent(e,"keyup",j)}});
STK.register("common.form.suggestInputHome",function(a){var b,c,d={},e,f,g,h,i,j,k,l,m,n,o,p={},q,r={},s,t="weibo";var u=false;return function(c,d){c=a.E(c);c.setAttribute("autocomplete","off");if(!c){throw"common.form.suggestInput : need el as a param"}var e="<#et tip data>"+"<ul>"+"<#list data as list>"+'<li action-type="suggestList"><a href="javascript:;" style="padding:5px 0; white-space:normal;"><span style="margin:0 5px;display:block;overflow:hidden;height:14px;">${list}</span></a></li>'+"</#list>"+"</ul>"+"</#et>";var f="T_"+a.core.util.getUniqueKey();var i=a.core.dom.sizzle('[node-type="suggestbox"]',c.parentNode)[0];b={url:"/ajax/aj_find_lenovo.php",template:e,focusTemplate:"",focusArgs:{type:"hot",key:""},focusclass:"current",left:0,top:0,width:0,focusback:a.core.func.empty,clickback:a.core.func.empty,blurback:a.core.func.empty,getDataback:a.core.func.empty,css:"",className:"K_menu_list",args:{},key:"key",defaultText:"",offset:{top:0,left:0}};r[f]=a.core.json.merge(b,d);m=a.core.evt.addEvent;n=a.core.evt.removeEvent;var j="__HOT_LIST_KEYWORD__";var s={clickItem:function(a){var b=a.el;r[f].clickback(a)},delItem:function(a){STK.core.evt.stopEvent();a.currentType=t;var b=a.el;delete p[r[f].url+q+"_"+f];i.style.display="block";r[f].delback(a);return false},hotKey:function(a){var b=a||window.event;var c=b.keyCode;if(!g){g=0}switch(c){case 38:s.upKey();break;case 40:s.downKey();break;case 13:s.enterKey();default:break}},downKey:function(){var b,d;if(!h||h.length==0){return}if(g>0){a.core.dom.removeClassName(h[g-1],r[f].focusclass)}g++;if(g>=h.length+1){g=0;c.value=l}if(g>0){a.core.dom.addClassName(h[g-1],r[f].focusclass);b=a.core.dom.builder(h[g-1]).list;d=b.suggestlist_text?b.suggestlist_text[0].innerText||b.suggestlist_text[0].textContent:l;c.value=d;k=h[g-1]}},upKey:function(){var b,d;if(!h||h.length==0){return}if(g>0){a.core.dom.removeClassName(h[g-1],r[f].focusclass)}g--;if(g<0){g=h.length}if(g>0){a.core.dom.addClassName(h[g-1],r[f].focusclass);b=a.core.dom.builder(h[g-1]).list;d=b.suggestlist_text?b.suggestlist_text[0].innerText||b.suggestlist_text[0].textContent:l;c.value=d;k=h[g-1]}else if(g<=0){c.value=l}a.preventDefault()},enterKey:function(){if(g-1<0){return}var b=h[g-1];a.core.evt.fireEvent(b,"click")},faceInit:function(b,c){var d={};if(b.searchHistoryData.length===0&&b.searchValueData.length===0){x.hide();return}if(!c){c=r[f].template}d.searchHistoryData=b.searchHistoryData?b.searchHistoryData:[];d.searchValueData=b.searchValueData?b.searchValueData:[];d.searchData=b.data;tipHTML=a.core.util.easyTemplate(a.lib.kit.extra.language(c),d);var e=decodeURIComponent(q);var j=new RegExp("(<a.*?>)(.*?)(</a>)","gi");var k=a.core.evt.delegatedEvent(i);k.add("suggestList","click",s.clickItem);k.add("suggestList_del","click",s.delItem);h=[];i.innerHTML=tipHTML;i.style.display="block";h=a.core.dom.sizzle('[action-type="suggestList"]',i);g=0}};var v=function(b,d){if(u){return}u=true;t=r[f].args.type?r[f].args.type:"weibo";q=encodeURIComponent(c.value);if(q==""){q=j}if(typeof p[r[f].url+q+"_"+f]!="undefined"){s.faceInit(p[r[f].url+q+"_"+f],b);if(typeof r[f].getDataback=="function"){r[f].getDataback(p[r[f].url+q+"_"+f])}u=false}else{d[r[f]["key"]]=q==j?"":q;a.core.io.ajax({url:r[f].url,args:d,method:"get",responseType:"json",onComplete:function(c){if(c.code=="100000"){c.searchHistoryData=[],c.searchValueData=[];var d={hot:"weibo",weibo:"weibo",user:"user",pic:"weibo",apps:"weibo",video:"video",article:"article",topic:"topic"};if(d[t]){t=d[t]}else{t=d[$CONFIG["pageid"]]?d[$CONFIG["pageid"]]:"weibo"}var e=t,g=a.core.util.storage.get(e),h,i=decodeURIComponent(q);if(g!="null"&&g!=""){h=g.replace(/^\|@\|/,"").replace(/\|@\|$/,"").split("|@|");if(i===j){a.core.arr.foreach(h,function(a,b){var d=a.replace(/&lt;/g,"&amplt;").replace(/&gt;/g,"&ampgt;").replace(/&quot;/g,"&ampquot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");c.searchHistoryData.push(d)})}else{c.searchHistoryData=[];a.core.arr.foreach(h,function(a,b){try{var d=new RegExp(i,"gi");if(d.test(a)){var e=a.replace(/&lt;/g,"&amplt;").replace(/&gt;/g,"&ampgt;").replace(/&quot;/g,"&ampquot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");c.searchHistoryData.push(e)}}catch(f){}})}}if(c.data&&c.data.length!=0){a.core.arr.foreach(c.data,function(a,b){c.searchValueData.push(a)})}if(c.searchHistoryData&&c.searchHistoryData.length>=3){c.searchHistoryData=c.searchHistoryData.slice(0,3)}if(q!=j){var k=[];if(c.searchHistoryData&&c.searchHistoryData.length!=0&&c.searchValueData&&c.searchValueData.length!=0){a.core.arr.foreach(c.searchValueData,function(b,d){var e=b,f=true;a.core.arr.foreach(c.searchHistoryData,function(a,b){if(!!e.key&&e.key===a||e===a){f=false}});if(f){k.push(b)}});c.searchValueData=k}}if(c.searchValueData&&c.searchValueData.length>=7){c.searchValueData=c.searchValueData.slice(0,7)}p[r[f].url+q+"_"+f]=c;s.faceInit(c,b);if(typeof r[f].getDataback=="function"){r[f].getDataback(c)}for(var l=0;l<c.searchValueData.length;l++){var m=c.searchValueData[l];if(m&&m.monitor&&m.monitor.ad_id){n(m)}}function n(a){var b={word:a.word,url_show:a.monitor.pc_show};var c=new Image;c.src="//j.s.weibo.com/doit.png"+"?type=show&position=s_suggest_show&word="+b.word+"&time="+ +(new Date);if(b.url_show){var d=new Image;d.src=decodeURIComponent(b.url_show).replace("__REQUESTID__","s_suggest_show"+ +(new Date))+"&word="+b.word}}}u=false}})}};var w=function(a,b){if(o){clearTimeout(o)}o=setTimeout(function(){if(b){v(a,r[f].focusArgs)}else{v(a,r[f].args)}},10)};var x={};var y=function(){var b=a.core.evt.getActiveElement();if(b!=c){x.hide()}};x.hide=function(){if(i.style.display=="block"){i.style.display="none";g=0;h=[];n(document.body,"click",y)}};x.show=function(b){if(c.value.length===0){x.showHot(r[f].focusTemplate);return}if(a.core.str.bLength(a.core.str.trim(c.value))==0){x.hide();return}w(b);l=c.value;m(document.body,"click",y)};x.showHot=function(a){w(a,true);l=c.value;m(document.body,"click",y)};a.common.form.valueChange(c,{callback:x.show,delay:100});a.addEvent(c,"focus",function(){if(c.value==r[f].defaultText){c.value=""}if(c.value==""&&r[f].focusTemplate){x.showHot(r[f].focusTemplate)}});a.addEvent(c,"blur",function(){if(a.bLength(a.trim(c.value))==0){c.value=r[f].defaultText}window.setTimeout(function(){x.hide()},200)});x.setOption=function(b){r[f]=a.core.json.merge(r[f],b);return x};m(c,"keydown",s.hotKey);return x}});
STK.register("common.channel.totalShow",function(a){var b=["click","keyup","setvalue","changeTotalNum","updateValue","changeStatus"];return a.common.channel.listener.define("common.channel.totalShow",b)});
STK.register("common.filter.calendarTemp",function(a){var b=""+"<#et userlist data>"+'<div class="selector">'+'<select action-type="month" class="month">'+"<option value=\"0\" ${data.showDate.month==0?'selected=\"\"':''}>#L{一月}</option>"+"<option value=\"1\" ${data.showDate.month==1?'selected=\"\"':''}>#L{二月}</option>"+"<option value=\"2\" ${data.showDate.month==2?'selected=\"\"':''}>#L{三月}</option>"+"<option value=\"3\" ${data.showDate.month==3?'selected=\"\"':''}>#L{四月}</option>"+"<option value=\"4\" ${data.showDate.month==4?'selected=\"\"':''}>#L{五月}</option>"+"<option value=\"5\" ${data.showDate.month==5?'selected=\"\"':''}>#L{六月}</option>"+"<option value=\"6\" ${data.showDate.month==6?'selected=\"\"':''}>#L{七月}</option>"+"<option value=\"7\" ${data.showDate.month==7?'selected=\"\"':''}>#L{八月}</option>"+"<option value=\"8\" ${data.showDate.month==8?'selected=\"\"':''}>#L{九月}</option>"+"<option value=\"9\" ${data.showDate.month==9?'selected=\"\"':''}>#L{十月}</option>"+"<option value=\"10\" ${data.showDate.month==10?'selected=\"\"':''}>#L{十一月}</option>"+"<option value=\"11\" ${data.showDate.month==11?'selected=\"\"':''}>#L{十二月}</option>"+"</select>"+'<select action-type="year" class="year">'+"<#list data.years as year>"+'<option value="${year}"${(data.showDate.year==year)?\' selected=""\':""}>${year}</option>'+"</#list>"+"</select>"+"</div>"+'<ul class="weeks">'+"<li>#L{日}</li><li>#L{一}</li><li>#L{二}</li><li>#L{三}</li><li>#L{四}</li><li>#L{五}</li><li>#L{六}</li>"+"</ul>"+'<ul class="days">'+"<#list data.dates as list>"+"<li>"+'<#if (list!="")>'+"<#if ("+"(data.start.year<data.showDate.year&&data.showDate.year<data.end.year)"+"||(data.start.year==data.showDate.year&&data.showDate.year<data.end.year&&data.start.month<data.showDate.month)"+"||(data.start.year==data.showDate.year&&data.showDate.year<data.end.year&&data.start.month==data.showDate.month&&data.start.date<=list&&list<=data.start.max)"+"||(data.start.year<data.showDate.year&&data.showDate.year==data.end.year&&data.showDate.month<data.end.month)"+"||(data.start.year<data.showDate.year&&data.showDate.year==data.end.year&&data.showDate.month==data.end.month&&list<=data.end.date)"+"||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month<data.showDate.month&&data.showDate.month<data.end.month)"+"||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month<data.showDate.month&&data.showDate.month==data.end.month&&list<=data.end.date)"+"||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month==data.showDate.month&&data.start.date<=list&&list<=data.start.max&&data.showDate.month<data.end.month)"+"||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month==data.showDate.month&&data.start.date<=list&&list<=data.start.max&&data.showDate.month==data.end.month&&list<=data.end.date)"+")>"+'<a action-type="date" href="#date" onclick="return false;" '+'title="${data.showDate.year}-${data.showDate.month+1}-${list}"'+'year="${data.showDate.year}" month="${data.showDate.month+1}" day="${list}"'+"${(data.today.year==data.showDate.year&&data.today.month==data.showDate.month&&list==data.showDate.date)?' class=\"day\"':''}><strong>${list}</strong></a>"+"<#else>"+"${list}"+"</#if>"+"</#if>"+"</li>"+"</#list>"+"</ul>";return b});
STK.register("common.filter.calendar",function(a){function e(){var b=arguments;this.today=this.getDefaultDate.apply(this,b);this.showDate={};for(var c in this.today){this.showDate[c]=this.today[c]}this.getKeyPoint.apply(this,b);this.getCurrentMonthInfo();a.custEvent.define(this,"close");a.custEvent.define(this,"show")}function d(){a.core.evt.stopEvent()}function c(){b.node.style.display="none";a.core.evt.removeEvent(document,"click",c);a.custEvent.fire(b,"close")}var b;e.prototype={data:{},defaultStartDate:new Date(2009,7,16,0,0,0,0),solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],maxMonthDay:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],solarDays:function(a,b){if(b==1){return a%4==0&&a%100!=0||a%400==0?29:28}else{return this.solarMonth[b]}},getDefaultDate:function(){var a=arguments;var b;var c;var d;var e;var f=/^(\d{4})[-\/](\d{1,2})[-\/](\d{1,2})$/;var g;var h;if(a.length==0){b=new Date}else if(f.test(a[0])){b=a[0].match(f);c=b[1]*1;d=b[2]*1-1;e=b[3]*1;b=new Date(c,d,e,0,0,0,0)}else if(a[0].constructor==Date){b=a[0]}else if(a.length==3){b=new Date(a[0],a[1],a[2],0,0,0,0)}else if(a[0]!=""&&typeof a[0]=="string"){b=new Date(a[0])}else{b=new Date}h={year:b.getFullYear(),month:b.getMonth(),date:b.getDate()};g=this.solarDays(h.year,h.month);h.max=g;return h},getKeyPoint:function(){var b=arguments;var c=b.length;var d;if(c>1){d=b[c-1];this.start=d.start!=null?d.start:this.defaultStartDate;this.end=d.end!=null?d.end:new Date;this.callback=d.callback;this.source=d.source;if(typeof this.start=="string"&&a.core.util.browser.IE6)this.start=this.start.replace("-","/");this.defaultStartDate=new Date(this.start)}else{this.start=this.defaultStartDate;this.end=new Date}this.start=this.getDefaultDate.call(this,this.start);this.end=this.getDefaultDate.call(this,this.end)},getCurrentMonthInfo:function(){var b=this.showDate;var c=b.year;var d=b.month;var e=b.date;var f=new Date(c,d,1,0,0,0,0);this.count=this.solarDays(c,d);this.firstWeek=f.getDay();var g=a.core.arr.copy(this.maxMonthDay);var h=this.firstWeek==0?[]:(new Array(this.firstWeek)).join().split(",");h=h.concat(g.splice(0,this.count));var i=$CONFIG!=null&&$CONFIG.timeDiff!=null?$CONFIG.timeDiff:0;var j=[];var k=this.defaultStartDate.getFullYear();var l=(new Date((new Date(this.end.year,this.end.month,this.end.date)).getTime()-i)).getFullYear();var m=l-k;var n=0;while(n<=m){j.push(k+n);n++}this.data={today:this.today,showDate:this.showDate,start:this.start,end:this.end,dates:h,years:j};this.showUI()},showUI:function(){var d=a.core;var e;var f;var g;var h;var i=this.getContainer();var j;if(this.source!=null){j=a.core.dom.position(this.source);j.t+=this.source.clientHeight}if(i==null){e=a.common.filter.calendarTemp;e='<div node-type="calendar" class="m-caldr" style="top:'+j.t+"px;left:"+j.l+'px;z-index:99999999">'+e+"</div>";f=d.util.easyTemplate(e);g=f(this.data).toString();g=a.lib.kit.extra.language(g);h=d.dom.builder(g);document.body.appendChild(h.box);i=this.getContainer();b=this;this.delegate(i);a.core.evt.addEvent(document,"click",c)}else{e=a.common.filter.calendarTemp;f=d.util.easyTemplate(e);g=f(this.data).toString();g=a.lib.kit.extra.language(g);i.innerHTML=g;i.style.cssText="display:block; top:"+j.t+"px;left:"+j.l+"px;z-index:99999999";if(i.style.display=="block"){a.core.evt.addEvent(document,"click",c)}b=this}this.node=i;a.custEvent.fire(b,"show");a.core.evt.stopEvent()},getContainer:function(){var b=a.core.dom.sizzle('[node-type="calendar"]',document.body);b=b.length>0?b[0]:null;return b},setYear:function(a){this.showDate.year=a;this.getCurrentMonthInfo();this.showUI()},setMonth:function(a){this.showDate.month=a*1;this.getCurrentMonthInfo();this.showUI()},setDate:function(a){a=a.replace(/(\d+)/g,function(a,b){return b.length==1?"0"+b:b});this.source.value=a;c();if(this.callback&&typeof this.callback=="function"){this.callback(a)}},delegate:function(c){var e=a.core.evt.delegatedEvent(c);e.add("month","change",function(a){var c=a.el.value;if(c!=b.showDate.month){b.setMonth(a.el.value)}});e.add("month","click",function(a){var c=a.el.value;if(c!=b.showDate.month){b.setMonth(a.el.value)}});e.add("year","change",function(a){var c=a.el.value;if(c!=b.showDate.year){b.setYear(c)}});e.add("year","click",function(a){var c=a.el.value;if(c!=b.showDate.year){b.setYear(c)}});e.add("date","click",function(a){b.setDate(a.el.title)});a.core.evt.addEvent(c,"click",d)}};return e});
STK.register("common.filter.parseSearchParam",function(a){var b=window.location.href;return function(){var c;var d,e;var f=b.substr(b.indexOf("&")+1);var g="nickname"+"=";var h=b.indexOf(g);var i;var j=b.indexOf("Refer");var k=a.queryToJson(f);if(k.region){c=k.region.split(":");k.prov=c[1];k.city=c[2];delete k.region}if(k.timescope){if(k.timescope.indexOf("%3A")>-1){k.timescope=k.timescope.replace(/%3A/g,":")}c=k.timescope.split(":");if(c[1]){d=c[1].split("-");k.stime=d[0]+"-"+d[1]+"-"+d[2];if(d[3]){k.startHour=d[3]}}if(c[2]){e=c[2].split("-");k.etime=e[0]+"-"+e[1]+"-"+e[2];if(e[3]){k.endHour=e[3]}}delete k.timescope}if(k.userscope){k.userscope=k.userscope.replace(/custom%253A|custom%3A|custom:/,"")}if(h>-1){i=decodeURIComponent(decodeURIComponent(b.substring(h+g.length)))}else{if(j>-1)i=decodeURIComponent(decodeURIComponent(b.substring(b.indexOf("user/")+5,b.indexOf("&"))));else i=""}k.nickName=i;return k}});
STK.register("lib.kit.extra.reuse",function(a){return function(b,c){var d,e,f;d=a.parseParam({},c);f=[];var g=function(){var a=b();f.push({store:a,used:true});return a};var h=function(b){a.foreach(f,function(a,c){if(b===a["store"]){a["used"]=true;return false}})};var i=function(b){a.foreach(f,function(a,c){if(b===a["store"]){a["used"]=false;return false}})};var j=function(){for(var a=0,b=f.length;a<b;a+=1){if(f[a]["used"]===false){f[a]["used"]=true;return f[a]["store"]}}return g()};e={};e.setUsed=h;e.setUnused=i;e.getOne=j;e.getLength=function(){return f.length};return e}});
STK.register("lib.module.layer",function(a){var b=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b};var c=function(c,d){d=d||"topleft";var e=null;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";e=a.core.dom.position(c);c.style.display="none";c.style.visibility="visible"}else{e=a.core.dom.position(c)}if(d!=="topleft"){var f=b(c);if(d==="topright"){e["l"]=e["l"]+f["w"]}else if(d==="bottomleft"){e["t"]=e["t"]+f["h"]}else if(d==="bottomright"){e["l"]=e["l"]+f["w"];e["t"]=e["t"]+f["h"]}}return e};return function(d){var e=a.core.dom.builder(d);var f=e.list["outer"][0],g=e.list["inner"][0];var h=a.core.dom.uniqueID(f);var i={};var j=a.core.evt.custEvent.define(i,"show");a.core.evt.custEvent.define(j,"hide");var k=null;i.show=function(){f.style.display="";a.core.evt.custEvent.fire(j,"show");return i};i.hide=function(){f.style.display="none";a.custEvent.fire(j,"hide");return i};i.getPosition=function(a){return c(f,a)};i.getSize=function(a){if(a||!k){k=b.apply(i,[f])}return k};i.html=function(a){if(a!==undefined){g.innerHTML=a}return g.innerHTML};i.text=function(b){if(text!==undefined){g.innerHTML=a.core.str.encodeHTML(b)}return a.core.str.decodeHTML(g.innerHTML)};i.appendChild=function(a){g.appendChild(a);return i};i.getUniqueID=function(){return h};i.getOuter=function(){return f};i.getInner=function(){return g};i.getParentNode=function(){return f.parentNode};i.getDomList=function(){return e.list};i.getDomListByKey=function(a){return e.list[a]};i.getDom=function(a,b){if(!e.list[a]){return false}return e.list[a][b||0]};i.getCascadeDom=function(b,c){if(!e.list[b]){return false}return a.core.dom.cascadeNode(e.list[b][c||0])};return i}});
STK.register("lib.module.dialog",function(a){return function(b,c){if(!b){throw"module.dialog need template as first parameter"}var d,e,f,g,h,i,j,k,l,m,n,o;l=true;var p=function(){if(l!==false){e.hide()}};var q=function(){d=a.parseParam({t:null,l:null,width:null,height:null},c);e=a.lib.module.layer(b,d);g=e.getOuter();h=e.getDom("title");k=e.getDom("title_content");i=e.getDom("inner");j=e.getDom("close");a.addEvent(j,"click",function(b){a.preventDefault(b);n();return false});a.custEvent.add(e,"show",function(){a.hotKey.add(document.documentElement,["esc"],p,{type:"keyup",disableInInput:true})});a.custEvent.add(e,"hide",function(){a.hotKey.remove(document.documentElement,["esc"],p,{type:"keyup"});l=true})};q();o=a.objSup(e,["show","hide"]);n=function(b){if(typeof m==="function"&&!b){if(m()===false){return false}}o.hide();if(a.contains(document.body,e.getOuter())){document.body.removeChild(e.getOuter())}return f};f=e;f.show=function(){if(!a.contains(document.body,e.getOuter())){document.body.appendChild(e.getOuter())}o.show();return f};f.hide=n;f.setPosition=function(a){g.style.top=a["t"]+"px";g.style.left=a["l"]+"px";return f};f.setMiddle=function(){var b=a.core.util.winSize();var c=e.getSize(true);g.style.top=a.core.util.scrollPos()["top"]+(b.height-c.h)/2+"px";g.style.left=(b.width-c.w)/2+"px";return f};f.setTitle=function(a){k.innerHTML=a;return f};f.setContent=function(a){if(typeof a==="string"){i.innerHTML=a}else{i.appendChild(a)}return f};f.clearContent=function(){while(i.children.length){a.removeNode(i.children[0])}return f};f.setAlign=function(){};f.setBeforeHideFn=function(a){m=a};f.clearBeforeHideFn=function(){m=null};f.unsupportEsc=function(){l=false};f.supportEsc=function(){l=true};return f}});
STK.register("lib.kit.dom.fix",function(a){function f(c,e,f){if(!d(c))return;var g="fixed",h,i,j,k,l=c.offsetWidth,m=c.offsetHeight,n=a.core.util.winSize(),o=0,p=0,q=a.core.dom.cssText(c.style.cssText);if(!b){g="absolute";var r=a.core.util.scrollPos();o=h=r.top;p=i=r.left;switch(e){case"lt":h+=f[1];i+=f[0];break;case"lb":h+=n.height-m-f[1];i+=f[0];break;case"rt":h+=f[1];i+=n.width-l-f[0];break;case"rb":h+=n.height-m-f[1];i+=n.width-l-f[0];break;case"c":default:h+=(n.height-m)/2+f[1];i+=(n.width-l)/2+f[0]}j=k=""}else{h=k=f[1];i=j=f[0];switch(e){case"lt":k=j="";break;case"lb":h=j="";break;case"rt":i=k="";break;case"rb":h=i="";break;case"c":default:h=(n.height-m)/2+f[1];i=(n.width-l)/2+f[0];k=j=""}}if(e=="c"){if(h<o)h=o;if(i<p)i=p}q.push("position",g).push("top",h+"px").push("left",i+"px").push("right",j+"px").push("bottom",k+"px");c.style.cssText=q.getCss()}function e(b){b=a.core.arr.isArray(b)?b:[0,0];for(var c=0;c<2;c++){if(typeof b[c]!="number")b[c]=0}return b}function d(b){return a.core.dom.getStyle(b,"display")!="none"}var b=!(a.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),c=/^(c)|(lt)|(lb)|(rt)|(rb)$/;return function(d,g,h){var i,j,k=true,l;if(a.core.dom.isNode(d)&&c.test(g)){var m={getNode:function(){return d},isFixed:function(){return k},setFixed:function(a){(k=!!a)&&f(d,i,j);return this},setAlign:function(a,b){if(c.test(a)){i=a;j=e(b);k&&f(d,i,j)}return this},destroy:function(){if(!b){b&&a.core.evt.removeEvent(window,"scroll",n)}a.core.evt.removeEvent(window,"resize",n);a.core.evt.custEvent.undefine(l)}};l=a.core.evt.custEvent.define(m,"beforeFix");m.setAlign(g,h);function n(c){c=c||window.event;a.core.evt.custEvent.fire(l,"beforeFix",c.type);if(k&&(!b||i=="c")){f(d,i,j)}}if(!b){a.core.evt.addEvent(window,"scroll",n)}a.core.evt.addEvent(window,"resize",n);return m}}});
STK.register("lib.module.mask",function(a){function k(b){var c;if(!(c=b.getAttribute(f))){b.setAttribute(f,c=a.getUniqueKey())}return">"+b.tagName.toLowerCase()+"["+f+'="'+c+'"]'}function j(){b=a.C("div");var c='<div node-type="outer">';if(a.core.util.browser.IE6){}c+="</div>";b=a.builder(c).list["outer"][0];document.body.appendChild(b);e=true;d=a.lib.kit.dom.fix(b,"lt");var f=function(){var c=a.core.util.winSize();b.style.cssText=a.core.dom.cssText(b.style.cssText).push("width",c.width+"px").push("height",c.height+"px").getCss()};i.add(d,"beforeFix",f);f()}var b,c=[],d,e=false,f="STK-Mask-Key";var g=a.core.dom.setStyle,h=a.core.dom.getStyle,i=a.core.evt.custEvent;var l={getNode:function(){return b},show:function(c,f){if(e){c=a.core.obj.parseParam({opacity:.3,background:"#000000"},c);b.style.background=c.background;g(b,"opacity",c.opacity);b.style.opacity=c.opacity;b.style.display="";d.setAlign("lt");f&&f()}else{j();l.show(c,f)}return l},hide:function(){b.style.display="none";nowIndex=undefined;c=[];return l},showUnderNode:function(d,e){if(a.isNode(d)){l.show(e,function(){g(b,"zIndex",h(d,"zIndex"));var e=k(d);var f=a.core.arr.indexOf(c,e);if(f!=-1){c.splice(f,1)}c.push(e);a.core.dom.insertElement(d,b,"beforebegin")})}return l},back:function(){if(c.length<1){return l}var d,e;c.pop();if(c.length<1){l.hide()}else if((e=c[c.length-1])&&(d=a.sizzle(e,document.body)[0])){g(b,"zIndex",h(d,"zIndex"));a.core.dom.insertElement(d,b,"beforebegin")}else{l.back()}return l},destroy:function(){i.remove(d);b.style.display="none";lastNode=undefined;_cache={}}};return l});
STK.register("lib.kit.dom.drag",function(a){return function(b,c){var d,e,f,g,h,i,j,k;var l=function(){m();n()};var m=function(){d=a.parseParam({moveDom:b,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},c);f=d.moveDom;e={};g={};h=a.drag(b,{actObj:d.actObj});if(d["dragtype"]==="perch"){i=a.C("div");j=false;k=false;f=i}b.style.cursor="move"};var n=function(){a.custEvent.add(d.actObj,"dragStart",o);a.custEvent.add(d.actObj,"dragEnd",p);a.custEvent.add(d.actObj,"draging",q)};var o=function(c,e){document.body.style.cursor="move";var f=a.core.util.pageSize()["page"];g=a.core.dom.position(d.moveDom);g.pageX=e.pageX;g.pageY=e.pageY;g.height=d.moveDom.offsetHeight;g.width=d.moveDom.offsetWidth;g.pageHeight=f["height"];g.pageWidth=f["width"];if(d["dragtype"]==="perch"){var h=[];h.push(d["perchStyle"]);h.push("position:absolute");h.push("z-index:"+(d.moveDom.style.zIndex+10));h.push("width:"+d.moveDom.offsetWidth+"px");h.push("height:"+d.moveDom.offsetHeight+"px");h.push("left:"+g["l"]+"px");h.push("top:"+g["t"]+"px");i.style.cssText=h.join(";");k=true;setTimeout(function(){if(k){document.body.appendChild(i);j=true}},100)}if(b.setCapture!==undefined){b.setCapture()}};var p=function(a,c){document.body.style.cursor="auto";if(b.setCapture!==undefined){b.releaseCapture()}if(d["dragtype"]==="perch"){k=false;d.moveDom.style.top=i.style.top;d.moveDom.style.left=i.style.left;if(j){document.body.removeChild(i);j=false}}};var q=function(a,b){var c=g.t+(b.pageY-g.pageY);var e=g.l+(b.pageX-g.pageX);var h=c+g["height"];var i=e+g["width"];var j=g["pageHeight"]-d["pagePadding"];var k=g["pageWidth"]-d["pagePadding"];if(h<j&&c>0){f.style.top=c+"px"}else{if(c<0){f.style.top="0px"}if(h>=j){f.style.top=j-g["height"]+"px"}}if(i<k&&e>0){f.style.left=e+"px"}else{if(e<0){f.style.left="0px"}if(i>=k){f.style.left=k-g["width"]+"px"}}};l();e.destroy=function(){document.body.style.cursor="auto";if(typeof f.setCapture==="function"){f.releaseCapture()}if(d["dragtype"]==="perch"){k=false;if(j){document.body.removeChild(i);j=false}}a.custEvent.remove(d.actObj,"dragStart",o);a.custEvent.remove(d.actObj,"dragEnd",p);a.custEvent.remove(d.actObj,"draging",q);if(h.destroy){h.destroy()}d=null;f=null;g=null;h=null;i=null;j=null;k=null};e.getActObj=function(){return d.actObj};return e}});
STK.register("lib.ui.dialog",function(a){var b=""+'<div class="m-layer" node-type="outer" style="position:absolute;z-index:10000000">'+'<div class="header">'+'<h6 class="title" node-type="title"><span node-type="title_content"></span></h6>'+'<a href="javascript:void(0);" class="wbicon close" node-type="close">X</a>'+"</div>"+'<div class="inner" node-type="inner">'+"</div>"+"</div>";var c=a.lib.kit.extra.language;var d=null,e;var f=function(){var b=a.lib.module.dialog(c(e["template"]));a.custEvent.add(b,"show",function(){a.lib.module.mask.showUnderNode(b.getOuter())});a.custEvent.add(b,"hide",function(){a.lib.module.mask.back();b.setMiddle()});a.lib.kit.dom.drag(b.getDom("title"),{actObj:b,moveDom:b.getOuter()});b.destroy=function(){g(b);try{b.hide(true)}catch(a){}};return b};var g=function(a){a.setTitle("").clearContent();d.setUnused(a)};return function(c){e=a.parseParam({template:b,isHold:false},c);var h=e["isHold"];e=a.core.obj.cut(e,["isHold"]);if(!d){d=a.lib.kit.extra.reuse(f)}var i=d.getOne();if(!h){a.custEvent.add(i,"hide",function(){a.custEvent.remove(i,"hide",arguments.callee);g(i)})}return i}});
STK.register("lib.ui.alert",function(a){var b='<div class="m-confirm" node-type="outer">'+'<p class="para" node-type="inner"><i class="" node-type="icon"></i><span node-type="textLarge"></span></p>'+'<div class="btn-box">'+'<a href="javascript:void(0)" class="s-btn-a" node-type="OK"></a>'+"</div>"+"</div>";var c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon-ques"};var d=a.lib.kit.extra.language;var e=null;var f=function(a,b){a.getDom("icon").className=b["icon"];a.getDom("textLarge").innerHTML=b["textLarge"];a.getDom("textSmall").innerHTML=b["textSmall"];a.getDom("OK").innerHTML="<span>"+b["OKText"]+"</span>"};return function(g,h,i){var j,k,l,m,n;j=a.parseParam({title:d("#L{提示}"),icon:"warn",textLarge:g,textSmall:"",OK:a.funcEmpty,OKText:d("#L{确定}"),timeout:0},h);j["icon"]=c[j["icon"]];k={};if(!e){e=a.lib.kit.extra.reuse(function(){var c=a.lib.module.layer(d(b));return c})}l=e.getOne();m=a.lib.ui.dialog();m.setContent(l.getOuter());m.setTitle(j["title"]);f(l,j);var o=function(b){m.is_closed=b.target.parentNode.getAttribute("node-type");a.preventDefault(b);m.hide()};a.addEvent(l.getDom("OK"),"click",o);a.custEvent.add(m,"hide",function(){a.custEvent.remove(m,"hide",arguments.callee);a.removeEvent(l.getDom("OK"),"click",o);e.setUnused(l);clearTimeout(n);m.is_closed=="OK"?j["OK"]():i[0].innerHTML=d("#L{评论}")});if(j["timeout"]){n=setTimeout(m.hide,j["timeout"])}m.show().setMiddle();k.alt=l;k.dia=m;return k}});
STK.register("common.filter.cityList",function(a){var b={"省/直辖市":{code:0,city:{"城市/地区":0}},"安徽":{code:34,city:{"合肥":1,"芜湖":2,"蚌埠":3,"淮南":4,"马鞍山":5,"淮北":6,"铜陵":7,"安庆":8,"黄山":10,"滁州":11,"阜阳":12,"宿州":13,"巢湖":14,"六安":15,"亳州":16,"池州":17,"宣城":18}},"北京":{code:11,city:{"东城区":1,"西城区":2,"崇文区":3,"宣武区":4,"朝阳区":5,"丰台区":6,"石景山区":7,"海淀区":8,"门头沟区":9,"房山区":11,"通州区":12,"顺义区":13,"昌平区":14,"大兴区":15,"怀柔区":16,"平谷区":17,"密云县":28,"延庆县":29}},"重庆":{code:50,city:{"万州区":1,"涪陵区":2,"渝中区":3,"大渡口区":4,"江北区":5,"沙坪坝区":6,"九龙坡区":7,"南岸区":8,"北碚区":9,"万盛区":10,"双桥区":11,"渝北区":12,"巴南区":13,"黔江区":14,"长寿区":15,"綦江县":22,"潼南县":23,"铜梁县":24,"大足县":25,"荣昌县":26,"璧山县":27,"梁平县":28,"城口县":29,"丰都县":30,"垫江县":31,"武隆县":32,"忠县":33,"开县":34,"云阳县":35,"奉节县":36,"巫山县":37,"巫溪县":38,"石柱土家族自治县":40,"秀山土家族苗族自治县":41,"酉阳土家族苗族自治县":42,"彭水苗族土家族自治县":43,"江津区":81,"合川市":82,"永川区":83,"南川市":84}},"福建":{code:35,city:{"福州":1,"厦门":2,"莆田":3,"三明":4,"泉州":5,"漳州":6,"南平":7,"龙岩":8,"宁德":9}},"甘肃":{code:62,city:{"兰州":1,"嘉峪关":2,"金昌":3,"白银":4,"天水":5,"武威":6,"张掖":7,"平凉":8,"酒泉":9,"庆阳":10,"定西":24,"陇南":26,"临夏":29,"甘南":30}},"广东":{code:44,city:{"广州":1,"韶关":2,"深圳":3,"珠海":4,"汕头":5,"佛山":6,"江门":7,"湛江":8,"茂名":9,"肇庆":12,"惠州":13,"梅州":14,"汕尾":15,"河源":16,"阳江":17,"清远":18,"东莞":19,"中山":20,"潮州":51,"揭阳":52,"云浮":53}},"广西":{code:45,city:{"南宁":1,"柳州":2,"桂林":3,"梧州":4,"北海":5,"防城港":6,"钦州":7,"贵港":8,"玉林":9,"百色":10,"贺州":11,"河池":12,"来宾":13,"崇左":14}},"贵州":{code:52,city:{"贵阳":1,"六盘水":2,"遵义":3,"安顺":4,"铜仁":22,"黔西南":23,"毕节":24,"黔东南":26,"黔南":27}},"海南":{code:46,city:{"海口":1,"三亚":2,"其他":90}},"河北":{code:13,city:{"石家庄":1,"唐山":2,"秦皇岛":3,"邯郸":4,"邢台":5,"保定":6,"张家口":7,"承德":8,"沧州":9,"廊坊":10,"衡水":11}},"黑龙江":{code:23,city:{"哈尔滨":1,"齐齐哈尔":2,"鸡西":3,"鹤岗":4,"双鸭山":5,"大庆":6,"伊春":7,"佳木斯":8,"七台河":9,"牡丹江":10,"黑河":11,"绥化":12,"大兴安岭":27}},"河南":{code:41,city:{"郑州":1,"开封":2,"洛阳":3,"平顶山":4,"安阳":5,"鹤壁":6,"新乡":7,"焦作":8,"濮阳":9,"许昌":10,"漯河":11,"三门峡":12,"南阳":13,"商丘":14,"信阳":15,"周口":16,"驻马店":17}},"湖北":{code:42,city:{"武汉":1,"黄石":2,"十堰":3,"宜昌":5,"襄阳":6,"鄂州":7,"荆门":8,"孝感":9,"荆州":10,"黄冈":11,"咸宁":12,"随州":13,"恩施土家族苗族自治州":28}},"湖南":{code:43,city:{"长沙":1,"株洲":2,"湘潭":3,"衡阳":4,"邵阳":5,"岳阳":6,"常德":7,"张家界":8,"益阳":9,"郴州":10,"永州":11,"怀化":12,"娄底":13,"湘西土家族苗族自治州":31}},"内蒙古":{code:15,city:{"呼和浩特":1,"包头":2,"乌海":3,"赤峰":4,"通辽":5,"鄂尔多斯":6,"呼伦贝尔":7,"兴安盟":22,"锡林郭勒盟":25,"乌兰察布盟":26,"巴彦淖尔盟":28,"阿拉善盟":29}},"江苏":{code:32,city:{"南京":1,"无锡":2,"徐州":3,"常州":4,"苏州":5,"南通":6,"连云港":7,"淮安":8,"盐城":9,"扬州":10,"镇江":11,"泰州":12,"宿迁":13}},"江西":{code:36,city:{"南昌":1,"景德镇":2,"萍乡":3,"九江":4,"新余":5,"鹰潭":6,"赣州":7,"吉安":8,"宜春":9,"抚州":10,"上饶":11}},"吉林":{code:22,city:{"长春":1,"吉林":2,"四平":3,"辽源":4,"通化":5,"白山":6,"松原":7,"白城":8,"延边朝鲜族自治州":24}},"辽宁":{code:21,city:{"沈阳":1,"大连":2,"鞍山":3,"抚顺":4,"本溪":5,"丹东":6,"锦州":7,"营口":8,"阜新":9,"辽阳":10,"盘锦":11,"铁岭":12,"朝阳":13,"葫芦岛":14}},"宁夏":{code:64,city:{"银川":1,"石嘴山":2,"吴忠":3,"固原":4,"中卫":5}},"青海":{code:63,city:{"西宁":1,"海东":21,"海北":22,"黄南":23,"海南":25,"果洛":26,"玉树":27,"海西":28}},"山西":{code:14,city:{"太原":1,"大同":2,"阳泉":3,"长治":4,"晋城":5,"朔州":6,"晋中":7,"运城":8,"忻州":9,"临汾":10,"吕梁":23}},"山东":{code:37,city:{"济南":1,"青岛":2,"淄博":3,"枣庄":4,"东营":5,"烟台":6,"潍坊":7,"济宁":8,"泰安":9,"威海":10,"日照":11,"莱芜":12,"临沂":13,"德州":14,"聊城":15,"滨州":16,"菏泽":17}},"上海":{code:31,city:{"黄浦区":1,"卢湾区":3,"徐汇区":4,"长宁区":5,"静安区":6,"普陀区":7,"闸北区":8,"虹口区":9,"杨浦区":10,"闵行区":12,"宝山区":13,"嘉定区":14,"浦东新区":15,"金山区":16,"松江区":17,"青浦区":18,"南汇区":19,"奉贤区":20,"崇明县":30}},"四川":{code:51,city:{"成都":1,"自贡":3,"攀枝花":4,"泸州":5,"德阳":6,"绵阳":7,"广元":8,"遂宁":9,"内江":10,"乐山":11,"南充":13,"眉山":14,"宜宾":15,"广安":16,"达州":17,"雅安":18,"巴中":19,"资阳":20,"阿坝":32,"甘孜":33,"凉山":34}},"天津":{code:12,city:{"和平区":1,"河东区":2,"河西区":3,"南开区":4,"河北区":5,"红桥区":6,"塘沽区":7,"汉沽区":8,"大港区":9,"东丽区":10,"西青区":11,"津南区":12,"北辰区":13,"武清区":14,"宝坻区":15,"宁河县":21,"静海县":23,"蓟县":25}},"西藏":{code:54,city:{"拉萨":1,"昌都":21,"山南":22,"日喀则":23,"那曲":24,"阿里":25,"林芝":26}},"新疆":{code:65,city:{"乌鲁木齐":1,"克拉玛依":2,"吐鲁番":21,"哈密":22,"昌吉":23,"博尔塔拉":27,"巴音郭楞":28,"阿克苏":29,"克孜勒苏":30,"喀什":31,"和田":32,"伊犁":40,"塔城":42,"阿勒泰":43,"石河子":44}},"云南":{code:53,city:{"昆明":1,"曲靖":3,"玉溪":4,"保山":5,"昭通":6,"楚雄":23,"红河":25,"文山":26,"思茅":27,"西双版纳":28,"大理":29,"德宏":31,"丽江":32,"怒江":33,"迪庆":34,"临沧":35}},"浙江":{code:33,city:{"杭州":1,"宁波":2,"温州":3,"嘉兴":4,"湖州":5,"绍兴":6,"金华":7,"衢州":8,"舟山":9,"台州":10,"丽水":11}},"陕西":{code:61,city:{"西安":1,"铜川":2,"宝鸡":3,"咸阳":4,"渭南":5,"延安":6,"汉中":7,"榆林":8,"安康":9,"商洛":10}},"台湾":{code:71,city:{"台北":1,"高雄":2,"基隆":3,"台中":4,"台南":5,"新竹":6,"嘉义":7,"其他":90}},"香港":{code:81,city:{"香港":1}},"澳门":{code:82,city:{"澳门":1}},"海外":{code:400,city:{"美国":1,"英国":2,"法国":3,"俄罗斯":4,"加拿大":5,"巴西":6,"澳大利亚":7,"印尼":8,"泰国":9,"马来西亚":10,"新加坡":11,"菲律宾":12,"越南":13,"印度":14,"日本":15,"其他":16}},"其他":{code:100,city:{"不限":1e3}}};return b});
STK.register("common.filter.regionSelect",function(a){var b=a.common.filter.cityList;return function(c){var d,e,f,g,h,i,j,k,l;d=c.provDom;e=c.cityDom||null;f=c.provCode||0;g=c.cityCode||0;if(typeof d=="undefined"){throw"Lack of provDom -> path : common.search.regionSelect"}d.options.length=0;h=d.options;for(var m in b){h[h.length]=new Option(m,b[m]["code"]);if(b[m]["code"]==f){i=true}}if(i){d.value=f}else{d.value=0}var n=function(a,c){g=c?c:g;k=b[a]["city"];e.options.length=0;l=e.options;l[0]=new Option("不限",1e3);for(var d in k){l[l.length]=new Option(d,k[d]);if(k[d]==g){j=true}}if(j){e.value=g}else{if(f!=0){e.value=1e3}else{e.value=0}}};if(e){a.core.evt.addEvent(d,"change",function(){n(d.options[d.selectedIndex].text,1e3)});n(d.options[d.selectedIndex].text)}}});
STK.register("common.dialog.masterIframe",function(a){var b,c,d,e;b={create:function(f){if(a.core.util.browser.IE6){if(c){b.destroy(c)}d=a.core.dom.position(f);e={w:f.offsetWidth,h:f.offsetHeight};zindex=a.core.dom.getStyle(f,"zIndex");c=a.C("DIV");c.style.cssText="left:"+d.l+";top:"+d.t+";position:absolute;z-index:"+(zindex-1);c.innerHTML='<iframe frameborder="no" width="'+e.w+'px" height="'+e.h+'px"></iframe>';document.body.appendChild(c);return b}return b},getOuter:function(){return c},destroy:function(){try{document.body.removeChild(c)}catch(a){}c=null},setPosition:function(a){c.style.top=a["t"]+"px";c.style.left=a["l"]+"px";return b},setSize:function(a){c.style.width=a.w+"px";c.style.height=a.h+"px"}};return b});
STK.register("common.form.suggestInput",function(a){var b,c,d={},e,f,g,h,i,j,k,l,m,n,o,p={},q,r={},s;var t=false;return function(i,j){i=a.E(i);if(!i){throw"common.form.suggestInput : need el as a param"}var u="<#et tip data>"+"<ul>"+"<#list data as list>"+'<li action-type="suggestList"><a href="javascript:;" style="padding:5px 0; white-space:normal;"><span style="margin:0 5px;display:block;overflow:hidden;height:14px;">${list}</span></a></li>'+"</#list>"+"</ul>"+"</#et>";var v="T_"+a.core.util.getUniqueKey();b={url:"/Ajax_Search/suggest",template:u,left:0,top:0,width:0,focusback:a.core.func.empty,clickback:a.core.func.empty,blurback:a.core.func.empty,css:"",className:"s_suggest_box",focusclass:"current",args:{},key:"key",defaultText:"",nameSelector:null,dataBack:a.core.func.empty,offset:{top:0,left:0}};c=function(a,b){var c;for(c in b){a[c]=b[c]}return a};r[v]=c(b,j);m=a.core.evt.addEvent;n=a.core.evt.removeEvent;var w={listOver:function(b){g=0;var c=b.el;clearTimeout(e);if(k){a.core.dom.removeClassName(k,r[v].focusclass)}k=c;e=setTimeout(function(){a.core.dom.addClassName(c,r[v].focusclass)},20)},listOut:function(b){var c=b.el;clearTimeout(f);f=setTimeout(function(){a.core.dom.removeClassName(c,r[v].focusclass)},10)},clickItem:function(a){var b=a.el;r[v].clickback({el:b})},hotKey:function(a){var b=a||window.event;var c=b.keyCode;if(!g){g=0}switch(c){case 38:w.upKey();break;case 40:w.downKey();break;case 13:w.enterKey();default:break}},downKey:function(){if(g>0){a.core.dom.removeClassName(h[g-1],r[v].focusclass)}g++;if(g>=h.length+1){g=0;i.value=l}if(g>0){var b=h[g-1],c,d=r[v].nameSelector;a.core.dom.addClassName(b,r[v].focusclass);if(r[v].nameSelector){c=a.sizzle(d,b)[0].innerHTML.replace(/<[^>]+>/g,"")}else{c=p[q+"_"+v].data[g-1]}i.value=c;k=b}},upKey:function(){if(g>0){a.core.dom.removeClassName(h[g-1],r[v].focusclass)}g--;if(g<0){g=h.length}if(g>0){var b=h[g-1],c,d=r[v].nameSelector;a.core.dom.addClassName(b,r[v].focusclass);if(r[v].nameSelector){c=a.sizzle(d,b)[0].innerHTML.replace(/<[^>]+>/g,"")}else{c=p[q+"_"+v].data[g-1]}i.value=c;k=h[g-1]}else if(g<=0){i.value=l}},enterKey:function(){if(g-1<0){return}var a=h[g-1];r[v].clickback({el:a})},faceInit:function(b){r[v].dataBack(b);if(b.data.length==0){z.hide();return}tipHTML=a.core.util.easyTemplate(r[v].template,b.data);if(!d[v]){d[v]=a.C("DIV");document.body.appendChild(d[v]);d[v].className=r[v].className;var c=a.core.evt.delegatedEvent(d[v]);c.add("suggestList","mouseover",w.listOver);c.add("suggestList","mouseout",w.listOut);c.add("suggestList","click",w.clickItem);h=[]}d[v].style.cssText="left:"+((r[v].left?r[v].left:a.core.dom.position(i).l)+(r[v].offset.left||0))+"px;top:"+((r[v].top?r[v].top:a.core.dom.position(i).t+i.offsetHeight)+(r[v].offset.top||0))+"px;width:"+((r[v].width?r[v].width:i.offsetWidth)-4)+"px;position:absolute;"+r[v].css;d[v].innerHTML=tipHTML;s=a.common.dialog.masterIframe.create(d[v]);h=a.core.dom.sizzle('[action-type="suggestList"]',d[v]);g=0}};var x=function(){if(t){return}t=true;q=encodeURIComponent(i.value);if(typeof p[q+"_"+v]!="undefined"){w.faceInit(p[q+"_"+v]);t=false}else{r[v].args[r[v].key]=q;a.core.io.ajax({url:r[v].url,args:r[v].args,method:"get",responseType:"json",onComplete:function(a){if(a.code=="100000"){p[q+"_"+v]=a;w.faceInit(a)}t=false}})}};var y=function(){if(o){clearTimeout(o)}o=setTimeout(x,200)};var z={};z.hide=function(){if(d[v]){d[v].style.display="none";g=0;h=[];n(document.body,"click");n(i,"click");s.destroy()}};z.show=function(){if(a.core.str.bLength(a.core.str.trim(i.value))==0){z.hide();return}y();l=i.value;m(document.body,"click",z.hide)};a.core.evt.addEvent(window,"resize",function(){if(d[v]&&d[v].style.display!="none")d[v].style.cssText="left:"+(a.core.dom.position(i).l+r[v].offset.left+1)+"px;top:"+(a.core.dom.position(i).t+i.offsetHeight+r[v].offset.top-1)+"px;width:"+(r[v].width?r[v].width:i.offsetWidth)+"px;position:absolute;"+r[v].css});a.common.form.valueChange(i,{callback:z.show,delay:100});a.addEvent(i,"focus",function(){if(i.value==r[v].defaultText){i.value=""}});a.addEvent(i,"blur",function(){if(a.bLength(a.trim(i.value))==0){i.value=r[v].defaultText}window.setTimeout(function(){z.hide()},200)});m(i,"keydown",w.hotKey);m(i,"click",function(){a.core.evt.stopEvent()});return z}});
STK.register("common.dialog.advSearch",function(a){var b=a.lib.kit.extra.language;var c=a.core.dom.sizzle;var d=false;var e,f;var g=b("#L{请选择日期}");var h=20;var i=$CONFIG.pageid;var j='<div class="m-adv-search" node-type="outer">'+'<div node-type="inner"></div>'+'<div class="btn-box">'+'<a href="javascript:void(0);" class="s-btn-a" node-type="OK" suda-data="key=tblog_search_'+i+"&value="+i+'_profes_OK">#L{'+(i==="user"?"搜索":"搜索微博")+"}</a>"+'<a href="javascript:void(0);" node-type="cancel" suda-data="key=tblog_search_'+i+"&value="+i+'_profes_cancel">#L{取消}</a>'+"</div>"+"</div>";var k=null;var l=function(a,b,c){a.getDom("inner").innerHTML=b["innerStr"]};var m=function(a,b){for(var c in a){if(!a[c]){delete a[c]}else if(a[c]==b[c]){delete a[c]}}return a};var n=function(b){var c=["timescope","region"];for(var d in b){if(!a.inArray(d,c)){b[d]=encodeURIComponent(b[d])}}return b};return function(c){var i,o,p,q,r;i=a.parseParam({title:b("#L{高级搜索}"),OK:a.funcEmpty,cancel:a.funcEmpty,timeout:0,innerStr:"",defaultConfig:{}},c);o={};if(!k){k=a.lib.kit.extra.reuse(function(){var c=a.lib.module.layer(b(j));return c})}p=k.getOne();q=a.lib.ui.dialog();q.setContent(p.getOuter());q.setTitle(i["title"]);l(p,i,q);var s=function(){var b={};var c=[];var d=a.builder(p.getDom("inner")).list,e;a.foreach(d,function(a){if(e=a[0]){b[e.getAttribute("node-type")]=e;if(e.getAttribute("suggest")){c.push(e)}}});if(b.prov&&b.city){a.common.filter.regionSelect({provDom:b.prov,cityDom:b.city?b.city:null,provCode:b.prov.getAttribute("truevalue"),cityCode:b.city?b.city.getAttribute("truevalue"):0})}var f={url:"/Ajax_Search/suggest",clickback:function(){},focusclass:"cur",className:"layer_menu_list",css:"z-index:10002"};a.foreach(c,function(b,c){f.url="/Ajax_Search/suggest?where="+b.name;var d=a.common.form.suggestInput(b,a.parseParam(f,{clickback:function(a){b.value=a.el.getElementsByTagName("A")[0].getElementsByTagName("SPAN")[0].innerHTML;setTimeout(function(){d.hide()},100)}}))})};var t=function(){var c,d;var j=a.sizzle('input[type="checkbox"]',p.getDom("inner"));var k=a.core.util.htmlToJson(p.getDom("inner"));var l=m(k,i.defaultConfig);c=k.keyword?encodeURIComponent(k.keyword):$CONFIG["s_search"];delete k.keyword;if($CONFIG.pageid=="user"){var o=true;for(var r in k){if(k[r]){if(r=="auth"){continue}else if(r=="gender"){continue}else if(r=="prov"&&k[r]==0){continue}else if(r=="city"&&k[r]==0){continue}else if(r=="age"){continue}o=false;break}}if(o){a.lib.ui.alert(b("#L{请补充昵称、标签、学校、公司、地点中任意一项}"),{OK:function(){q.getOuter().style.display=""}});if(a.core.util.browser.IE6){q.getOuter().style.display="none"}return false}}if(k.prov&&k.prov!=0){k.region="custom:"+k.prov+":"+k.city;delete k.prov;delete k.city}if(k.prov==0){delete k.prov;delete k.city}if(k.xsort=="live"){delete k.xsort}if(k.auth=="all"){delete k.auth}if(k.age=="all"){delete k.age}if(k.type){if(k.type=="hot")k["xsort"]="hot";else if(k.type=="ori")k["scope"]="ori";else if(k.type=="category_4")k["category"]="4";else if(k.type=="category_5")k["category"]="5";else k[k.type]=1;delete k.type}if(k.sub){k[k.sub]=1;delete k.sub}if(k.userscope){if(k.userscope.length>=h){k.userscope=k.userscope.substr(0,h)}k.userscope="custom:"+k.userscope}if(k.stime||k.etime){k.stime=k.stime?k.stime:"";k.stime=k.stime==g?"":k.stime;k.etime=k.etime?k.etime:"";k.etime=k.etime==g?"":k.etime;if(k.stime||k.etime){k.timescope="custom:"+(k.stime?k.stime:"")+":"+(k.etime?k.etime:"");e=k.stime;f=k.etime}delete k.stime;delete k.etime}if(k.startHour||k.endHour){e+=k.startHour?"-"+k.startHour:"";f+=k.endHour?"-"+k.endHour:"";delete k.startHour;delete k.endHour;k.timescope="custom:"+e+":"+f}if(k.tag||k.school||k.work||k.nickname){c=""}if(k.nickname){if(k.nickname.length>=h){k.nickname=k.nickname.substr(0,h)}}var s=a.core.json.jsonToQuery(n(k));if(s){s="&"+s}var t=location.href;$CONFIG.pageid=="user"?c="":c=c;if(window.location.href.indexOf("/weibo/")>-1||window.location.href.indexOf("user")>-1||window.location.href.indexOf("/wb/")>-1){if(t.indexOf("?")>0){var u=t.substr(0,t.lastIndexOf("?"))+"?q="+c+s+"&Refer=g"}else{var u=t.substr(0,t.lastIndexOf("/"))+"?q="+c+s+"&Refer=g"}}else{var v=a.sizzle("[node-type=work]")[0];if(!v){if(!!c==false){a.lib.ui.alert(b("#L{请输入关键词}"),{OK:function(){q.getOuter().style.display=""}});if(a.core.util.browser.IE6){q.getOuter().style.display="none"}return}u=t.substr(0,t.lastIndexOf("/")+1)+"weibo?q="+c+s+"&Refer=g"}else if(v){c="";if(!k.nickname&&!k.tag&&!k.school&&!k.work&&!k.region&&!k.age){a.lib.ui.alert(b("#L{请输入至少一个搜索条件}"),{OK:function(){q.getOuter().style.display=""}});if(a.core.util.browser.IE6){q.getOuter().style.display="none"}return}u=t.substr(0,t.lastIndexOf("/")+1)+"user?q="+c+s+"&Refer=g"}}var w=u.replace(/(top\/|list\/)/,"");setTimeout(function(){window.location.href=w},0);q.hide()};if(!d){d=true;a.addEvent(p.getDom("OK"),"click",t)}a.addEvent(p.getDom("cancel"),"click",q.hide);a.custEvent.add(q,"hide",function(){a.custEvent.remove(q,"hide",arguments.callee);a.removeEvent(p.getDom("OK"),"click",q.hide);k.setUnused(p);clearTimeout(r);i["OK"]()});if(i["timeout"]){r=setTimeout(q.hide,i["timeout"])}q.show().setMiddle();s();o.alt=p;o.dia=q;return o}});
STK.register("common.extra.shine",function(a){var b=function(a){return a.slice(0,a.length-1).concat(a.concat([]).reverse())};return function(c,d){var e=a.parseParam({start:"#fff",color:"#fbb",times:2,step:5},d);var f=e["start"].split("");var g=e["color"].split("");var h=[];for(var i=0;i<e["step"];i+=1){var j=f[0];for(var k=1;k<4;k+=1){var l=parseInt(f[k],16);var m=parseInt(g[k],16);j+=Math.floor(parseInt(l+(m-l)*i/e["step"],10)).toString(16)}h.push(j)}for(var i=0;i<e["times"];i+=1){h=b(h)}var n=false;var o=a.timer.add(function(){if(!h.length){a.timer.remove(o);return}if(n){n=false;return}else{n=true}c.style.backgroundColor=h.pop()})}});
STK.register("common.filter.advSearch",function(a){return function(b,c){var d=a.lib.kit.extra.language;var e={};var f=[],g,h,i,j,k="",l=d("#L{请选择日期}"),m,n,o,p,q;var r={typeall:"",suball:"",xsort:"",vip:"",atten:"",haspic:"",hasvideo:"",userscope:"",scope:"",stime:"",etime:"",prov:0,city:0,hasvideo:0,hasmusic:0,haslink:0,startHour:"",endHour:"",category:"",viewpoint:"",discuss:""};var s=d("<#et weibo data>"+'<dl class="clearfix">'+"<dt>#L{关键词}：</dt>"+"<dd>"+'<input type="text" value="#myValue#" class="txt" name="keyword"/>'+"</dd>"+"</dl>"+'<dl class="clearfix"><dt>#L{类型}：</dt><dd>'+'<label for="radio01"><input type="radio" name="type" checked ${data.typeall == 1 ? ("checked=checked"): ""} value="typeall" id="radio01" >#L{全部}</label>'+'<label for="radio02"><input type="radio" name="type" ${data.xsort ==  "hot"? ("checked=checked"): ""} value="hot" id="radio02" >#L{热门}</label>'+'<label for="radio03"><input type="radio" name="type" ${data.scope == "ori" ? ("checked=checked"): ""} value="ori" id="radio03" >#L{原创}</label>'+'<label for="radio04"><input type="radio" name="type" ${data.atten == 1 ? ("checked=checked"): ""} value="atten" id="radio04" >#L{关注人}</label>'+'<label for="radio05"><input type="radio" name="type" ${data.vip == 1 ? ("checked=checked"): ""} value="vip" id="radio05" >#L{认证用户}</label>'+'<label for="radio07"><input type="radio" name="type" ${data.category == 4 ? ("checked=checked"): ""} value="category_4" id="radio07" >#L{媒体}</label>'+'<label for="radio08"><input type="radio" name="type" ${data.viewpoint == 1 ? ("checked=checked"): ""} value="viewpoint" id="radio08" >#L{观点}</label>'+'<label for="radio09" style="display:none;"><input type="radio" name="type" ${data.discuss == 1 ? ("checked=checked"): ""} value="discuss" id="radio09" >#L{网友讨论}</label>'+"</dd></dl>"+'<dl class="clearfix"><dt>#L{包含}：</dt><dd>'+'<label for="radio_sub1"><input name="sub" type="radio" checked ${data.suball == 1 ? ("checked=checked"): ""} value="suball" id="radio_sub1" />#L{全部}</label>'+'<label for="radio_sub2"><input name="sub" type="radio" ${data.haspic == 1 ? ("checked=checked"): ""} value="haspic" id="radio_sub2" />#L{含图片}</label>'+'<label for="radio_sub3"><input name="sub" type="radio" ${data.hasvideo == 1 ? ("checked=checked"): ""} value="hasvideo" id="radio_sub3" />#L{含视频}</label>'+'<label for="radio_sub4"><input name="sub" type="radio" ${data.hasmusic == 1 ? ("checked=checked"): ""} value="hasmusic" id="radio_sub4" />#L{含音乐}</label>'+'<label for="radio_sub5"><input name="sub" type="radio" ${data.haslink == 1 ? ("checked=checked"): ""} value="haslink" id="radio_sub5" />#L{含短链}</label></dd></dl>'+'<dl class="time clearfix">'+"<dt>#L{时间}：</dt>"+'<dd><input type="text" readonly="true" value="${data.stime}" node-type="stime" name="stime" action-type="time" style="vertical-align: middle;" />'+($CONFIG.lang!="en-us"?'<select isFirst=1 name="startHour" action-type="selectHour" node-type="startHour"><option value="">#L{选择时间}</option></select>':"")+"#L{至  }"+'<input type="text" readonly="true" value="${data.etime}"  action-type="time" name="etime" node-type="etime" style="vertical-align: middle;" />'+($CONFIG.lang!="en-us"?'<select isFirst=1 name="endHour" action-type="selectHour" node-type="endHour"><option value="">#L{选择时间}</option></select></dd>':"")+"</dl>"+($CONFIG.lang!="en-us"?'<dl class="clearfix"><dt>#L{地点}：</dt>'+'<dd><select name="prov" node-type="prov" truevalue="${data.prov}"><option></option></select>'+'<select name="city" node-type="city" truevalue="${data.city}"><option></option></select></dd></dl>':"")+"</#et>");var t={};var u={adv_search:function(){var b=a.common.filter.getConfig;var c=b.htmlspecialchars(b.s_search($CONFIG["s_search"]));h=a.common.dialog.advSearch({innerStr:a.core.util.easyTemplate(s,g).toString().replace("#myValue#",c),defaultConfig:{},title:"微博高级搜索",OK:function(a){}});if(a.core.util.browser.IE6){a.custEvent.add(h.dia,"hide",function(){a.core.evt.fireEvent(document.body,"click")})}if(!i){i=true;j=a.sizzle('[node-type="attentDD"]',h.dia.getInner())[0];var e=a.delegatedEvent(h.dia.getInner());e.add("byTime","click",u.byTime);e.add("byHot","click",u.byHot);e.add("bySocail","click",u.bySocail);e.add("selectHour","click",u.selectHour);e.add("time","click",u.show_date)}m=a.sizzle('[node-type="startHour"]',h.dia.getInner())[0];n=a.sizzle('[node-type="endHour"]',h.dia.getInner())[0];o=a.sizzle('[node-type="stime"]',h.dia.getInner())[0];p=a.sizzle('[node-type="etime"]',h.dia.getInner())[0];if(m){for(var f=0;f<24;f++){m[f+1]=new Option(f+d("#L{时}"),f);n[f+1]=new Option(f+d("#L{时}"),f)}if(g.startHour){m.options[parseInt(g.startHour)+1].selected=true}if(g.endHour){n.options[parseInt(g.endHour)+1].selected=true}if(!g.stime||g.stime==l){m.disabled=true}if(!g.etime||g.etime==l){n.disabled=true}}},bySocail:function(){j.style.display="";j.getElementsByTagName("INPUT")[0].checked=false},byHot:function(){j=a.sizzle('[node-type="attentDD"]',h.dia.getInner())[0];j.style.display="none";j.getElementsByTagName("INPUT")[0].checked=false},byTime:function(){j.style.display="";j.getElementsByTagName("INPUT")[0].checked=false},selectHour:function(b){var c=b.el;if(c.getAttribute("node-type")=="startHour"){if(!o.value){a.common.extra.shine(o)}}else{if(!p.value){a.common.extra.shine(p)}}},show_date:function(b){if(b.el.value==l){b.el.value=""}var c=new a.common.filter.calendar(b.el.value,{source:b.el,callback:function(){if(b.el.value){if(m){b.el.getAttribute("node-type")=="stime"?m.disabled=false:n.disabled=false}}}})}};var v={};var w={};var x=function(){y();z();A();B();C();D();E()};var y=function(){if(!b)throw"[pl_advsearchWeibo] : missing  -> path : common.filter.advsearchWeibo";c=a.core.obj.parseParam({html:""},c)};var z=function(){var c=a.builder(b).list,d;a.foreach(c,function(a){if(d=a[0]){f[d.getAttribute("node-type")]=d}})};var A=function(){g=a.common.filter.parseSearchParam();g=a.core.obj.parseParam(r,g);g.stime?g.stime=g.stime:g.stime=l;g.etime?g.etime=g.etime:g.etime=l};var B=function(){};var C=function(){a.core.evt.addEvent(b,"click",u.adv_search)};var D=function(){};var E=function(){};var F=function(){a.core.evt.removeEvent(b,"click",u.adv_search)};x();e.destroy=F;e.eventHandler=u.adv_search;return e}});
STK.register("common.search.parseSearchParam",function(a){var b=window.location.href;return function(){var c;var d,e;var f=b.substr(b.indexOf("&")+1);var g="nickname"+"=";var h=b.indexOf(g);var i;var j=b.indexOf("Refer");var k=a.queryToJson(f);if(k.region){c=k.region.split(":");k.prov=c[1];k.city=c[2];delete k.region}if(k.timescope){if(k.timescope.indexOf("%3A")>-1){k.timescope=k.timescope.replace(/%3A/g,":")}c=k.timescope.split(":");if(c[1]){d=c[1].split("-");k.stime=d[0]+"-"+d[1]+"-"+d[2];if(d[3]){k.startHour=d[3]}}if(c[2]){e=c[2].split("-");k.etime=e[0]+"-"+e[1]+"-"+e[2];if(e[3]){k.endHour=e[3]}}delete k.timescope}if(k.userscope){k.userscope=k.userscope.replace(/custom%253A|custom%3A|custom:/,"")}if(h>-1){i=decodeURIComponent(decodeURIComponent(b.substring(h+g.length)))}else{if(j>-1)i=decodeURIComponent(decodeURIComponent(b.substring(b.indexOf("user/")+5,b.indexOf("&"))));else i=""}k.nickName=i;return k}});
STK.register("common.filter.advsearchUser",function(a){return function(b,c){var d={};var e=[];var f=false,g,h;var i=a.lib.kit.extra.language;var j={nickname:"",tag:"",school:"",work:"",auth:"",prov:0,city:0,age:"all",gender:"all"};var k=i("<#et user data>"+'<div class="m-adv-search">'+"<dl>"+"<dt>#L{昵称}：</dt>"+'<dd><input type="text" name="nickname" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.nickname)))}" class="txt" /></dd>'+"</dl>"+"<dl>"+"<dt>#L{标签}：</dt>"+'<dd><input node-type="tag" suggest="true" type="text" name="tag" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.tag)))}" class="txt" /></dd>'+"</dl>"+"<dl>"+"<dt>#L{学校}：</dt>"+'<dd><input node-type="school" suggest="true" type="text" name="school" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.school)))}" class="txt" /></dd>'+"</dl>"+"<dl>"+"<dt>#L{公司}：</dt>"+'<dd><input node-type="work" suggest="true" type="text" name="work" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.work)))}" class="txt" / ></dd>'+"</dl>"+"<dl>"+"<dt>#L{用户}：</dt>"+'<dd><select hidefocus="true" name="auth" node-type="auth" truevalue="${data.auth}">'+'<option value="all" >#L{所有用户}</option>'+'<option ${data.auth == "org_vip" ? "selected" : ""} value="org_vip">#L{机构认证}</option>'+'<option ${data.auth == "per_vip" ? "selected" : ""} value="per_vip">#L{个人认证}</option>'+'<option ${data.auth == "ord" ? "selected" : ""} value="ord">#L{普通用户}</option>'+"</select>"+"</dd>"+"</dl>"+($CONFIG.lang!="en-us"?'<dl class="adv_add clearfix"><dt>#L{地点}：</dt>'+'<dd class="conbox"><select hidefocus="true" class="select2" name="prov" node-type="prov" truevalue="${data.prov}"><option></option></select></dd>'+'<dd class="conbox"><select hidefocus="true" class="select2" name="city" node-type="city" truevalue="${data.city}"><option></option></select></dd>'+"</dl>":"")+"<dl>"+"<dt>#L{年龄}：</dt>"+'<dd class="conbox"><select hidefocus="true" name="age" class="select2">'+'<option value="all">#L{不限}</option>'+'<option ${data.age == "18y" ? "selected" : ""} value="18y">#L{18岁以下}</option>'+'<option ${data.age == "22y" ? "selected" : ""} value="22y">19~22#L{岁}</option>'+'<option ${data.age == "29y" ? "selected" : ""} value="29y">23~29#L{岁}</option>'+'<option ${data.age == "39y" ? "selected" : ""} value="39y">30~39#L{岁}</option>'+'<option ${data.age == "40y" ? "selected" : ""} value="40y">#L{40岁以上}</option>'+"</select>"+"</dd>"+"</dl>"+"<dl>"+"<dt>#L{性别}：</dt>"+'<dd><select hidefocus="true" class="select2" name="gender" value="${data.gender}"><option value="">#L{不限}</option><option ${data.gender == "man" ? "selected" : ""} value="man">#L{男}</option><option ${data.gender == "women" ? "selected" : ""} value="women">#L{女}</option></select></dd>'+"</dl>"+"</div>"+"</#et>");var l={adv_search:function(){if(!g.auth){g.auth="all"}a.common.dialog.advSearch({innerStr:a.core.util.easyTemplate(k,g),defaultConfig:{}})}};var m=function(){n();o();p();q()};var n=function(){if(!b)throw"[pl_advsearchUser] : missing  -> path : common.filter.advsearchUser";c=a.core.obj.parseParam({html:""},c)};var o=function(){var c=a.builder(b).list,d;a.foreach(c,function(a){if(d=a[0]){e[d.getAttribute("node-type")]=d}})};var p=function(){h=a.common.search.parseSearchParam();g=a.parseParam(j,h)};var q=function(){a.core.evt.addEvent(b,"click",l.adv_search)};m();return d}});
STK.register("common.filter.dealUrl",function(a){var b={};var c=function(b,c,d){var e;var f=d||window.location.href;if(f.indexOf("&")>0){var g=f.substr(0,f.indexOf("&"));var h=f.substr(f.indexOf("&")).substr(1);var i=a.core.json.queryToJson(h);delete i["Refer"];i[b]=c;var j=a.core.json.jsonToQuery(i);e=g+"&"+j}else{e=f+"&"+b+"="+c}return e};var d=function(b,c){var d;var e=c||window.location.href;if(e.indexOf("&")<0){return e}var f=e.substr(0,e.indexOf("&"));var g=e.substr(e.indexOf("&")).substr(1);var h=a.core.json.queryToJson(g);if(h[b]){delete h[b];var i=true;for(var j in h){i=false}if(!i){var k=a.core.json.jsonToQuery(h);d=f+"&"+k}else{d=f}}else{d=e}return d};b.merge_url=c;b.delete_type=d;return b});
STK.register("pl.searchbar.search",function(a){var b="pl.searchbar.search";var c;var d;var e;var f;var g="";var h;var i;var j=$CONFIG["pageid"];var k=a.common.filter.dealUrl;var l="";var m=j;if($CONFIG.pageid.indexOf("friend_")!=-1){m="user"}if($CONFIG.pageid==="top"){m="weibo"}l=$CONFIG["s_domain"]+"/"+m+"?q=";var n=j=="index"?window.location.href+"/weibo/":window.location.href;return function(b,j){var m={};var o={getRefer:function(){switch($CONFIG.pageid){case"weibo":g="&Refer=SWeibo_box";h="&Refer=SWeibo_lian";break;case"user":g="&Refer=SUer_box";h="&Refer=SUer_lian";break;case"article":g="&Refer=SListRelpage_box";h="&Refer=SListRelpage_lian";break;case"video":g="&Refer=SVideo_box";h="&Refer=SVideo_lian";break;case"pic":g="&Refer=Spic_box";h="&Refer=Spic_lian";break;case"topic":g="&Refer=Stopic_box";h="&Refer=Stopic_lian";break;case"related":g="&Refer=Srelated_box";h="&Refer=Srelated_lian";break;case"realtime":g="&Refer=Srealtime_box";h="&Refer=Srealtime_lian";break;case"hot":g="&Refer=Shot_box";h="&Refer=Shot_lian";break;case"top":g="&Refer=top_summary";h="&Refer=top_summary_lian";break;default:g="";h=""}}};var p={submit:function(b){a.core.evt.preventDefault();if(c.text.value===""){window.location.href=$CONFIG["s_domain"];return}window.location.href=p.getSearchUrl()},textFocus:function(a){i.show()},valChange:function(b){e=c.text.value;a.common.channel.totalShow.fire("updateValue",{newVal:e});if(e!=d){c.submit.href=p.getSearchUrl();d=e}},getSearchUrl:function(a){var b=window.location.href;var d="";var e=b.indexOf("&");var f="";if(e!=-1){f=b.substr(e)}if($CONFIG["pageid"]=="top"){d=$CONFIG["s_domain"]+"/weibo?q="+encodeURIComponent(c.text.value)+f}else{d=$CONFIG["s_domain"]+"/"+$CONFIG["pageid"]+"?q="+encodeURIComponent(c.text.value)+f}d=k.delete_type("Refer",d);d=k.delete_type("page",d);return d+g},changeSearchType:function(b){e=c.text.value;e=encodeURIComponent(e)||$CONFIG["s_search"];var d=b.evt.target||b.evt.srcElement;var f=a.core.str.queryString("Refer",{source:d.toString()});if(f===null){a.preventDefault();return}if(!e){window.location.href="/?Refer="+(!f?"":f);a.preventDefault()}}};var q={moreFactor:function(){var b=a.lib.kit.extra.language;var c={nickname:"",tag:"",school:"",work:"",auth:"",prov:0,city:0,age:"all",gender:"all"};var d=a.common.search.parseSearchParam();var e=a.parseParam(c,d);var f=b("<#et user data>"+'<dl class="adv_input clearfix">'+"<dt>#L{昵称}：</dt>"+'<dd class="conbox"><input type="text" name="nickname" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.nickname)))}" class="W_inputStp" /></dd>'+"</dl>"+'<dl class="adv_input clearfix">'+"<dt>#L{标签}：</dt>"+'<dd class="conbox"><input node-type="tag" suggest="true" type="text" name="tag" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.tag)))}" class="W_inputStp" /></dd>'+"</dl>"+'<dl class="adv_input clearfix">'+"<dt>#L{学校}：</dt>"+'<dd class="conbox"><input node-type="school" suggest="true" type="text" name="school" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.school)))}" class="W_inputStp" /></dd>'+"</dl>"+'<dl class="adv_input clearfix">'+"<dt>#L{公司}：</dt>"+'<dd class="conbox"><input node-type="work" suggest="true" type="text" name="work" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.work)))}" class="W_inputStp" / ></dd>'+"</dl>"+'<dl class="adv_user clearfix">'+"<dt>#L{用户}：</dt>"+'<dd class="conbox"><select hidefocus="true" class="select2" name="auth" node-type="auth" truevalue="${data.auth}">'+'<option value="all" >#L{所有用户}</option>'+'<option ${data.auth == "org_vip" ? "selected" : ""} value="org_vip">#L{机构认证}</option>'+'<option ${data.auth == "per_vip" ? "selected" : ""} value="per_vip">#L{个人认证}</option>'+'<option ${data.auth == "ord" ? "selected" : ""} value="ord">#L{普通用户}</option>'+"</select>"+"</dd>"+"</dl>"+($CONFIG.lang!="en-us"?'<dl class="adv_add clearfix"><dt>#L{地点}：</dt>'+'<dd class="conbox"><select hidefocus="true" class="select2" name="prov" node-type="prov" truevalue="${data.prov}"><option></option></select></dd>'+'<dd class="conbox"><select hidefocus="true" class="select2" name="city" node-type="city" truevalue="${data.city}"><option></option></select></dd>'+"</dl>":"")+'<dl class="adv_age clearfix">'+"<dt>#L{年龄}：</dt>"+'<dd class="conbox"><select hidefocus="true" name="age" class="select2">'+'<option value="all">#L{不限}</option>'+'<option ${data.age == "18y" ? "selected" : ""} value="18y">#L{18岁以下}</option>'+'<option ${data.age == "22y" ? "selected" : ""} value="22y">19~22#L{岁}</option>'+'<option ${data.age == "29y" ? "selected" : ""} value="29y">23~29#L{岁}</option>'+'<option ${data.age == "39y" ? "selected" : ""} value="39y">30~39#L{岁}</option>'+'<option ${data.age == "40y" ? "selected" : ""} value="40y">#L{40岁以上}</option>'+"</select>"+"</dd>"+"</dl>"+'<dl class="adv_sex clearfix">'+"<dt>#L{性别}：</dt>"+'<dd class="conbox"><select hidefocus="true" class="select2" name="gender" value="${data.gender}"><option value="">#L{不限}</option><option ${data.gender == "man" ? "selected" : ""} value="man">#L{男}</option><option ${data.gender == "women" ? "selected" : ""} value="women">#L{女}</option></select></dd>'+"</dl>"+"</#et>");if(!e.auth){e.auth="all"}a.common.dialog.advSearch({innerStr:a.core.util.easyTemplate(f,e),defaultConfig:{}})}};var r=function(){s();t();u();v()};var s=function(){if(!b)throw"path : pl.feedtop.search"};var t=function(){c=a.lib.kit.dom.parseDOM(a.builder(b).list)};var u=function(){d=c.text.value;o.getRefer();if(c.advsearch){a.common.filter.advSearch(c.advsearch)}if(c.advsearchUser){a.common.filter.advsearchUser(c.advsearchUser)}var b={parent:c.text.parentNode,action:function(){p.submit()}};a.common.form.enterSubmit(b);var e=n.substr(l.length,n.length);var g;if(e.substr(0,1)!="&"){g="search="+e}else{g=e.substr(1,e.length)}var h=a.core.json.queryToJson(g);var j=["search","notice","work","school","tag"];var k,m;for(k=0,m=j.length;k<m;k++){if(typeof h[j[k]]!="undefined"){f=j[k];break}}var q=$CONFIG.pageid;if($CONFIG.pageid==="top"){q="weibo"}var r="/Ajax_Search/suggest?where="+q+"&key="+"";i=a.common.form.suggestInputHome(c.text,{className:"m-sug-list",focusclass:"current",template:"<#et tip data>"+"<#if (data.searchHistoryData.length != 0)>"+'<ul class="history">'+"<#list data.searchHistoryData as list>"+"<#if (list.length != 0)>"+'<li action-type="suggestList">'+'<a href="javascript:void(0)" class="wbicon del" action-type="suggestList_del" style="padding-left:10px;">X</a>'+'<i class="icon-clock"></i>'+'<a href="javascript:void(0)" node-type="suggestlist_text" >${list}</a>'+"</li>"+"</#if>"+"</#list>"+"</ul>"+"</#if>"+"<#if (data.searchValueData.length != 0&&data.searchHistoryData.length != 0)>"+'<div class="s-hr"></div>'+"</#if>"+"<#if (data.searchValueData.length != 0)>"+'<ul class="sug">'+"<#list data.searchValueData as list>"+'<li action-type="suggestList">'+'<a href="javascript:void(0)" node-type="suggestlist_text">${list.word}</a>'+"</li>"+"</#list>"+"</ul>"+"</#if>"+"</#et>",focusTemplate:"<#et tip data>"+"<#if (data.searchHistoryData.length != 0)>"+'<ul class="history">'+"<#list data.searchHistoryData as list>"+"<#if (list.length != 0)>"+'<li action-type="suggestList">'+'<a href="javascript:void(0)" class="wbicon del" action-type="suggestList_del" style="padding-left:10px;">X</a>'+'<i class="icon-clock"></i>'+'<a href="javascript:void(0)" node-type="suggestlist_text" >${list}</a>'+"</li>"+"</#if>"+"</#list>"+"</ul>"+'<div class="s-hr"></div>'+"</#if>"+'<ul class="hotrank">'+"<#list data.searchValueData as list>"+"<#if (typeof list === 'object')>"+"<#if (typeof list.monitor === 'object')>"+'<li action-type="suggestList" word="${list.word}" url_show="${list.monitor.pc_show}" url_click="${list.monitor.pc_click}" ad_id="${list.monitor.ad_id}">'+"<#else>"+'<li action-type="suggestList">'+"</#if>"+'<i class="icon-num ${list_index<=2?"num-top":""}">${list_index + 1}</i>'+'<a href="javascript:void(0)" node-type="suggestlist_text">${list.word}</a>'+"</li>"+"<#else>"+"</#if>"+"</#list>"+"</ul>"+'<div class="more"><a href="/top/summary/" title="完整热搜榜">完整热搜榜»</a></div>'+"</#et>",focusArgs:{type:"hot",key:""},url:r,args:{type:q},width:c.text.offsetWidth+16,offset:{left:-8,top:0},clickback:function(b){var d=a.builder(b.el).list,e;if(!d.suggestlist_text){return}e=d.suggestlist_text[0].innerText;var f={word:b.el.getAttribute("word"),ad_id:b.el.getAttribute("ad_id"),url_click:b.el.getAttribute("url_click")};if(f.ad_id){var g=false,h=false;var i=new Image;i.onload=l;i.error=k;i.src="//j.s.weibo.com/doit.png?type=click&position=s_suggest_click&word="+f.word+"&time="+ +(new Date);if(f.url_click){var j=new Image;j.onload=m;j.error=k;j.src=decodeURIComponent(f.url_click).replace("__REQUESTID__","s_suggest_click"+ +(new Date))+"&word="+f.word}function k(a){lock=true;window.location.href="/weibo?q="+encodeURIComponent(f.word)}function l(a){g=true;f.url_click?n():k()}function m(a){h=true;n()}function n(){if(g&&h){lock=true;window.location.href="/weibo?q="+encodeURIComponent(f.word)}}}else{c.text.value=a.trim(e);p.submit()}},delback:function(b){var c=b.currentType,d=a.core.util.storage.get(c),e,f="|@|",g,h;if(d==="null"){return}g=a.builder(b.el.parentNode);if(g.list.suggestlist_text){h=g.list.suggestlist_text[0].innerText||g.list.suggestlist_text[0].textContent;e=d.replace(f+h+f,f);if(e.length<=3){e=""}a.core.util.storage.set(c,e);g.box.parentElement.removeChild(g.box);i.show()}}})};var v=function(){a.core.evt.addEvent(c.submit,"click",p.submit);a.core.evt.addEvent(c.text,"keyup",p.valChange);a.core.evt.addEvent(c.text,"focus",p.textFocus)};var w=function(){};r();m.destory=w;return m}});
STK.register("pl.searchbar.index",function(a){var b=a.E("pl_feedtop_top");if(b){return a.pl.searchbar.search(b)}});
STK.register("lib.kit.extra.merge",function(a){return function(a,b){var c={};for(var d in a){c[d]=a[d]}for(var d in b){c[d]=b[d]}return c}});
STK.register("lib.kit.io.ajax",function(a){var b=function(b,c,d){c=c|0||1;d=d||"fail";var e=b["args"];if(e["__rnd"]){delete e["__rnd"]}(new Image).src="//weibolog.sinaapp.com/?t="+c+"&u="+encodeURIComponent(b["url"])+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d};return function(c){var d,e,f,g,h,i,j;i=function(a){h=false;c.onComplete(a,d["args"]);setTimeout(k,0)};j=function(a){h=false;if(typeof c.onFail==="function"){c.onFail(a,d["args"])}setTimeout(k,0);try{b(d)}catch(e){}};f=[];g=null;h=false;d=a.parseParam({url:"",method:"get",responseType:"json",timeout:30*1e3,onTraning:a.funcEmpty,isEncode:true},c);d["onComplete"]=i;d["onFail"]=j;d["onTimeout"]=function(){try{b(d)}catch(a){}};var k=function(){if(!f.length){return}if(h===true){return}h=true;d.args=f.shift();if(d.method.toLowerCase()=="post"){var b=a.core.util.URL(d.url);b.setParam("__rnd",(new Date).valueOf());d.url=b.toString()}g=a.ajax(d)};var l=function(a){while(f.length){f.shift()}h=false;if(g){try{g.abort()}catch(b){}}g=null};e={};e.request=function(a){if(!a){a={}}if(c["noQueue"]){l()}if(!c["uniqueRequest"]||!g){f.push(a);a["_t"]=0;k()}};e.abort=l;return e}});
STK.register("lib.kit.io.jsonp",function(a){return function(b){var c,d,e,f,g;c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:30*1e3,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:true},b);e=[];f={};g=false;var h=function(){if(!e.length){return}if(g===true){return}g=true;f.args=e.shift();f.onComplete=function(a){g=false;c.onComplete(a,f["args"]);setTimeout(h,0)};f.onFail=function(a){g=false;c.onFail(a);setTimeout(h,0)};a.jsonp(a.lib.kit.extra.merge(c,{args:f.args,onComplete:function(a){f.onComplete(a)},onFail:function(a){try{f.onFail(a)}catch(b){}}}))};d={};d.request=function(a){if(!a){a={}}e.push(a);a["_t"]=1;h()};d.abort=function(a){while(e.length){e.shift()}g=false;f=null};return d}});
STK.register("lib.kit.io.inter",function(a){return function(){var b,c,d;b={};c={};d={};b.register=function(a,b){if(c[a]!==undefined){throw a+" interface has been registered"}c[a]=b;d[a]={}};b.hookComplete=function(b,c){var e=a.core.util.getUniqueKey();d[b][e]=c;return e};b.removeHook=function(a,b){if(d[a]&&d[a][b]){delete d[a][b]}};b.getTrans=function(b,e){var f=a.lib.kit.extra.merge(c[b],e);f.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if(a["code"]==="100000"){try{e.onSuccess(a,c)}catch(f){}}else{try{if(a["code"]==="100002"){window.location.href=a["data"];return}e.onError(a,c)}catch(f){}}for(var g in d[b]){try{d[b][g](a,c)}catch(f){}}};if(c[b]["requestMode"]==="jsonp"){return a.lib.kit.io.jsonp(f)}else if(c[b]["requestMode"]==="ijax"){return a.lib.kit.io.ijax(f)}else{return a.lib.kit.io.ajax(f)}};b.request=function(b,e,f){var g=a.core.json.merge(c[b],e);g.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if(a["code"]==="100000"){try{e.onSuccess(a,c)}catch(f){}}else{try{if(a["code"]==="100002"){window.location.href=a["data"];return}e.onError(a,c)}catch(f){}}for(var g in d[b]){try{d[b][g](a,c)}catch(f){}}};g=a.core.obj.cut(g,["noqueue"]);g.args=f;if(c[b]["requestMode"]==="jsonp"){return a.jsonp(g)}else if(c[b]["requestMode"]==="ijax"){return a.ijax(g)}else{return a.ajax(g)}};return b}});
STK.register("common.trans.global",function(a){var b=a.lib.kit.io.inter();var c=b.register;c("add",{url:"/ajax_User/follow",method:"post"});c("del",{url:"/ajax_User/unfollow",method:"post"});c("addgroup",{url:"/ajax_User/addgroup",method:"post"});c("setgroup",{url:"/ajax_User/addUserToGroup",method:"post"});c("listgroup",{url:"/ajax/user/GroupList",method:"get"});c("followTopic",{url:"/Ajax_object/stopicFollow",method:"post"});c("followList",{url:"/Ajax_Search/suggest",method:"get"});c("publish",{url:"/Ajax_Mblog/publish",method:"post"});c("share",{url:"/ajax/mblog/searchshare",method:"post"});c("topshare",{url:"/ajax/mblog/searchshare",method:"post"});c("upcover",{url:"/ajax/claim/uploadpic",method:"post"});c("commitcover",{url:"/ajax/claim/Setinfo",method:"post"});c("weiboActs",{url:"/ajax/claim/topicweibo",method:"get"});c("weibotop",{url:"/ajax/claim/shield",method:"get"});c("setAD",{url:"/aj/proxy/adclickserve",method:"post"});c("setADMonitor",{url:"/aj/proxy/monitor",method:"post"});c("adDeal",{url:"/aj/ad/deal",method:"post"});c("playstatistics",{url:"/aj/video/playstatistics",method:"post"});c("playInteractLog",{url:"/aj/log/h5playlog",method:"post"});c("newVideoUrl",{url:"/aj/mblog/videourl",method:"get"});c("third_rend",{url:"/aj/mblog/renderfeed",method:"post"});return b});
STK.register("common.channel.relation",function(a){var b=["follow","unFollow","removeFans","block","unBlock","addFriends","removeFriends","updateRemark"];return a.common.channel.listener.define("common.channel.relation",b)});
STK.register("lib.ui.confirm",function(a){var b='<div class="m-confirm" node-type="outer">'+'<p class="para" node-type="inner"><i class="" node-type="icon"></i><span node-type="textLarge"></span><span node-type="textComplex"></span>'+'<span node-type="textSmall"></span></p>'+'<div class="btn-box">'+'<a href="javascript:void(0)" class="s-btn-a" node-type="OK"></a>'+'<a href="javascript:void(0)" node-type="cancel"></a>'+"</div>"+"</div>";var c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon-ques"};var d=a.lib.kit.extra.language;var e=null;return function(f,g){var h,i,j,k,l,m;h=a.parseParam({title:d("#L{提示}"),icon:"question",textLarge:f,textComplex:"",textSmall:"",OK:a.funcEmpty,OKText:d("#L{确定}"),cancel:a.funcEmpty,cancelText:d("#L{取消}")},g);h["icon"]=c[h["icon"]];i={};if(!e){e=a.lib.kit.extra.reuse(function(){var c=a.lib.module.layer(b);return c})}j=e.getOne();k=a.lib.ui.dialog();k.setContent(j.getOuter());j.getDom("icon").className=h["icon"];j.getDom("textLarge").innerHTML=h["textLarge"];j.getDom("OK").innerHTML=h["OKText"];j.getDom("cancel").innerHTML=h["cancelText"];k.setTitle(h["title"]);var n=function(){l=true;m=a.htmlToJson(j.getDom("textComplex"));k.hide()};a.addEvent(j.getDom("OK"),"click",n);a.addEvent(j.getDom("cancel"),"click",k.hide);a.custEvent.add(k,"hide",function(){a.custEvent.remove(k,"hide",arguments.callee);a.removeEvent(j.getDom("OK"),"click",n);a.removeEvent(j.getDom("cancel"),"click",k.hide);e.setUnused(j);if(l){h["OK"](m)}else{h["cancel"](m)}});k.show().setMiddle();i.cfm=j;i.dia=k;return i}});
STK.register("common.dialog.setGroup",function(a){var b=16;return function(){var c={},d=a.lib.kit.extra.language,e=a.lib.ui.dialog({isHold:true}),f=a.lib.ui.alert,g={groupBox:'<div class="m-setup-group" node-type="group_panel" >'+'<input type="hidden" node-type="uid" name="touid">'+'<div class="remark" node-type="remarkPanel">#L{备注名称：}<input node-type="remarkInput" type="text" placeholder="#L{设置备注}" name="remark"></div>'+'<div class="setup">'+'<div class="top">'+"<div>"+'<i class="icon-warn icon-ques-s" action-type="tipsLayer"></i>为什么要设置分组？'+'<div class="tips" node-type="groupTips">'+"<ul>"+"<li>#L{在首页可以设定的分组查看微博}</li>"+"<li>#L{将已经关注的人设置分组，方便管理}</li>"+"<li>#L{分组信息是保密的，只有自己可见}</li>"+"</ul>"+'<i class="arrow-up"></i>'+"</div>"+"</div>"+'<p node-type="message"></p>'+"</div>"+'<div class="group">'+'<div node-type="loading">#L{正在加载，请稍候...}</div>'+'<ul class="list" node-type="groupList">'+"</ul>"+'<div class="add" node-type="addGroupPanel">'+'<div node-type="showBtnBox">'+'<a href="javascript:;" action-type="showBtn"><i class="wbicon">+</i>#L{创建新分组}</a>'+"</div>"+'<div node-type="addGroupBox" style="display:none;">'+'<input node-type="groupInput" type="text" value="#L{新分组}" >　'+'<a href="javascript:;" class="s-btn-d" action-type="addGroup"><span>#L{创建}</span></a>　'+'<a href="javascript:;" action-type="hideBtn">#L{取消}</a>'+'<p style="display:none;" node-type="errorTips"><i class="icon-warn icon-del-s"></i></p>'+"</div>"+"</div>"+"</div>"+"</div>"+'<div class="btn-box">'+'<a href="javascript:;" class="s-btn-a" action-type="submit"><span>#L{确定}</span></a>'+'<a href="javascript:;" action-type="cancel"><span>#L{取消}</span></a>'+"</div>"+"</div>",checkBox:'<label for="group_{groupId}"><input type="checkbox" value="{value}" name="gid" {checked} id="group_{groupId}">{name}</label>'},h={title:"#L{关注成功}",gEmpty:"#L{分组名不能为空}",rEmpty:"#L{备注名不能为空}",gMaxLen:"#L{请不要超过16个字符}",gDefVal:"#L{新分组}",okLabel:"#L{设置成功}",rDefVal:"#L{设置备注}",message:"#L{为}+“#{nickName}”+#L{选择分组}",repeat:"#L{此分组名已存在}"},i=false,j=[],k,l,m,n,o,p,q,r;var s=function(){k["remarkInput"].value=d(h["rDefVal"]);k["groupInput"].value=d(h["gDefVal"]);k["loading"].style.display="";k["groupList"].innerHTML="";k["showBtnBox"].style.display="";k["addGroupBox"].style.display="none"};var t=function(b){s();var c=a.parseParam({uid:"",fnick:"",hasRemark:true,groupList:[],title:d(h["title"]),successCb:function(){},cancelCb:function(){}},b);q=c.successCb;r=c.cancelCb;k["uid"].value=c.uid;if(c["hasRemark"]){k["remarkInput"].removeAttribute("disabled");k["remarkPanel"].style.display=""}else{k["remarkInput"].setAttribute("disabled","disabled");k["remarkPanel"].style.display="none"}c["groupList"].length?y(c["groupList"]):A.request({uid:c["uid"]});k["message"].innerHTML=d("#L{为}“"+c.fnick+"”#L{选择分组}");e.setTitle(c["title"]);e.appendChild(k["group_panel"]);e.show().setMiddle()};var u=function(){e.hide()};var v={defVal:d(h["gDefVal"]),check:function(b){var c="";if(b===""||b===this.defVal){c=h["gEmpty"]}else if(a.core.str.bLength(b)>16){c=h["gMaxLen"]}return d(c)},checkRepeat:function(a){var b="";for(var c=j.length;c--;){if(a===j[c]["gname"]){b=h["repeat"];break}}return d(b)},showError:function(a){k["errorTips"].innerHTML='<i class="icon-warn icon-del-s"></i>'+a;k["errorTips"].style.display=""},hideError:function(){k["errorTips"].style.display="none"}};var w={defVal:d(h["rDefVal"]),check:function(b){var c="";if(b===""){c=h["rEmpty"]}else if(a.core.str.bLength(b)>16){c=h["gMaxLen"]}return d(c)},showError:function(a){},hideError:function(){}};var x=function(b){var c=a.C("li");var d=g["checkBox"].replace(/\{value\}/g,b.gid).replace(/\{groupId\}/g,b.gid).replace(/\{name\}/g,b.gname).replace(/\{checked\}/g,b.belong?"checked":"");c.innerHTML=d;return c};var y=function(a){j=a;k["addGroupPanel"].style.display=a.length>=20?"none":"";var b=document.createDocumentFragment();for(var c=0,d=a.length;c<d;c++){var e=x(a[c]);b.appendChild(e)}k["groupList"].appendChild(b);k["loading"].style.display="none"};var z={errorCd:function(b,c){a.lib.ui.alert("出现了一点错误呢")},getGroupSuccess:function(a,b){var c=a.data||[];y(c)},setGroupSuccess:function(a,b){u();f(d(h["okLabel"]),{icon:"success",timeout:1e3});q(a,b)},setGroupError:function(a,b){v.showError(a.msg)},addGroupSuccess:function(a,b){var c=a.data,e;k["addGroupPanel"].style.display=c.length>=20?"none":"";for(var f=c.length;f--;){if(c[f].belong===1){e=c[f];break}}e&&j.push(e);var g=x(e);k["groupList"].appendChild(g);D.hideAddPanel();k["groupInput"].value=d(h["gDefVal"])}};var A=a.common.trans.global.getTrans("listgroup",{onSuccess:z["getGroupSuccess"],onError:z["errorCd"]});var B=a.common.trans.global.getTrans("setgroup",{onSuccess:z["setGroupSuccess"],onError:z["errorCd"]});var C=a.common.trans.global.getTrans("addgroup",{onSuccess:z["addGroupSuccess"],onError:z["errorCd"]});var D={showAddPanel:function(){k["showBtnBox"].style.display="none";k["addGroupBox"].style.display="";k["groupInput"].focus()},hideAddPanel:function(){k["showBtnBox"].style.display="";k["addGroupBox"].style.display="none";v.hideError();k["groupInput"].value=v.defVal},addGroup:function(){var b=a.trim(k["groupInput"].value),c=v.check(b)||v.checkRepeat(b);if(c){v.showError(c)}else{v.hideError();C.request({name:b})}},submit:function(){var b=a.trim(k["groupInput"].value),c=v.checkRepeat(b);if(c){v.showError(c);return}i=true;v.hideError();var e=a.htmlToJson(k["group_panel"]);var f=[];e.gid=f.concat(e.gid).join(",");v.check(b)||(e.newgroup=b);if(e.remark===d(h["rDefVal"])){e.remark=""}B.request(e)},cancel:function(){i=false;u()},inputFocus:function(b){return function(c){var c=a.fixEvent(c),d=c.target,e=d.value;b.hideError();e===b["defVal"]&&(d.value="")}},inputBlur:function(b){return function(c){var c=a.fixEvent(c),d=c.target,e=a.trim(d.value);e||(d.value=b["defVal"])}},inputMaxLen:function(c){var c=a.fixEvent(c),d=c.target,e=d.value,f=a.core.str.bLength(e);f>16&&(d.value=a.core.str.leftB(e,b))}};var E=function(){H();F();G()};var F=function(){l=a.core.evt.delegatedEvent(k["group_panel"]);m=D.inputFocus(v);n=D.inputBlur(v);o=D.inputFocus(w);p=D.inputBlur(w);a.addEvent(k["remarkInput"],"focus",o);a.addEvent(k["remarkInput"],"blur",p);a.addEvent(k["groupInput"],"focus",m);a.addEvent(k["groupInput"],"blur",n);a.addEvent(k["remarkInput"],"keyup",D.inputMaxLen);a.addEvent(k["groupInput"],"keyup",D.inputMaxLen);l.add("showBtn","click",D.showAddPanel);l.add("hideBtn","click",D.hideAddPanel);l.add("addGroup","click",D.addGroup);l.add("submit","click",D.submit);l.add("cancel","click",D.cancel)};var G=function(){a.custEvent.add(e,"hide",function(){i||r()})};var H=function(){var b=a.core.dom.builder(d(g["groupBox"]));k=a.lib.kit.dom.parseDOM(b.list)};var I=function(){a.removeEvent(k["remarkInput"],"focus",o);a.removeEvent(k["remarkInput"],"blur",p);a.removeEvent(k["groupInput"],"focus",m);a.removeEvent(k["groupInput"],"blur",n);a.removeEvent(k["remarkInput"],"keyup",D.inputMaxLen);a.removeEvent(k["groupInput"],"keyup",D.inputMaxLen);m=null;n=null;o=null;p=null;l&&l.destroy()};E();c.show=t;c.hide=u;c.destroy=I;return c}});
STK.register("common.trans.validateCode",function(a){var b=a.lib.kit.io.inter();var c="/ajax/";var d=b.register;d("checkAnswer",{url:c+"pincode/verified?",method:"post"});return b});
STK.register("lib.kit.io.cssLoader",function(a){var b="";var c="//img.t.sinajs.cn/t4/";var d="//timg.sjs.sinajs.cn/t4/";if(typeof $CONFIG!="undefined"){c=$CONFIG.cssPath||c;b=$CONFIG["version"]||""}var e={};return function(f,g,h,i,j){i=i||b;h=h||function(){};var k=function(a,b){var c=e[a]||(e[a]={loaded:false,list:[]});if(c.loaded){b(a);return false}c.list.push(b);if(c.list.length>1){return false}return true};var l=function(a){var b=e[a].list;for(var c=0;c<b.length;c++){b[c](a)}e[a].loaded=true;delete e[a].list};if(!k(f,h))return;var m;if(j){m=d+f}else{m=c+f+"?version="+i}var n=a.C("link");n.setAttribute("rel","Stylesheet");n.setAttribute("type","text/css");n.setAttribute("charset","utf-8");n.setAttribute("href",m);document.getElementsByTagName("head")[0].appendChild(n);var o=a.C("div");o.id=g;a.core.util.hideContainer.appendChild(o);var p=3e3;var q=function(){if(parseInt(a.core.dom.getStyle(o,"height"))==42){a.core.util.hideContainer.removeChild(o);l(f);return}if(--p>0){setTimeout(q,10)}else{a.log(f+"timeout!");a.core.util.hideContainer.removeChild(o);delete e[f]}};setTimeout(q,50)}});
STK.register("common.dialog.authentication",function(a){return function(b){var c=a.lib.kit.extra.language,d=a.core.util.browser;b=a.parseParam({src:"//weibo.com/a/verify/realname?stage=home_verification&from=search",icon:"warn",isHold:true,width:"380px",height:"240px",title:c("#L{帐号验证}")},b||{});var e={},f,g,h=false;var i="tblog_checkfailed_reform";var j={init:function(){!(d.IE6||d.IE7)&&(window.document.domain="weibo.com");f=a.lib.ui.dialog(b);var c=[];c.push('<iframe id="account_authentication" name="account_authentication" node-type="frame" width="'+b.width+'" height="'+b.height+'" allowtransparency="true" scrolling="no" frameborder="0" src=""></iframe>');var e=a.builder(c.join(""));f.setTitle(b.title);f.setContent(e.box);var g=f.getDomList();a.addEvent(g["close"][0],"click",function(){history.go(0)})},show:function(){try{SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_box")}catch(c){}if(!h){a.lib.kit.io.cssLoader("style/css/module/layer/layer_check_identity.css","js_style_css_module_layer_check_identity",function(){h=true})}f.show().setMiddle();g=a.E("account_authentication");var d=decodeURIComponent(b.src)+"&rnd=";if(g.attachEvent){g.attachEvent("onload",function(){g.height=b.height;f.setMiddle()})}else{g.onload=function(){g.height=b.height;f.setMiddle()}}g.src=d+a.core.util.getUniqueKey()},destroy:function(){},hook:function(a,b){try{if(a=="100000"){j.verifySucc()}else{j.verifyFail()}}catch(c){}},verifySucc:function(){SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_success");f.hide();var b={title:c("#L{提示}"),icon:"success",OK:function(){SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_play");history.go(0)},OKText:c("#L{进入首页}"),msg:c("#L{恭喜，您的身份已验证成功，马上进入新浪微博。}")};var d=a.lib.ui.alert(b.msg,b);a.custEvent.add(d,"hide",function(){history.go(0)})},verifyFail:function(){SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_twotimes");f.hide();var b={title:c("#L{提示}"),icon:"warn",OK:function(){SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_triple");j.show()},OKText:c("#L{再次验证}"),msg:c("#L{抱歉，您的身份信息不准确，请再次验证。<br/>}")+'<a class="W_spetxt" suda-data="key=tblog_checkfailed_reform&value=checkfailed_havealook" href="//weibo.com">'+c("#L{您也可以先体验微博，随后再验证身份信息>>}")+"</a>"};var d=a.lib.ui.alert(b.msg,b);a.custEvent.add(d,"hide",function(){history.go(0)})}};j.init();e.destroy=j.destroy;e.show=j.show;window["App"]=window["App"]||{};window["App"]["checkRealName"]=j.hook;return e}});
STK.register("common.layer.ioError",function(a){var b=a.lib.kit.extra.language;var c;return function(d,e,f){f=f||function(){};var g={100001:function(){a.lib.ui.alert(e.msg)},100002:function(){window.location.reload()},100003:function(){var c=a.parseParam({location:"",icon:"warn",title:b("#L{提示}"),OKText:b("#L{确认}"),cancelText:b("#L{取消}"),suda:""},e.data);c["OK"]=function(){a.preventDefault();var b=a.queryToJson(e.data.OKSuda||"");SUDA.uaTrack&&b.key&&SUDA.uaTrack(b.key,b.value);e["ok"]&&e["ok"]();window.location.href=c.location};c["cancel"]=function(){a.preventDefault();var b=a.queryToJson(e.data.cancelSuda||"");SUDA.uaTrack&&b.key&&SUDA.uaTrack(b.key,b.value);e["cancel"]&&e["cancel"]()};a.lib.ui.confirm(e.msg,c)},100004:function(){if(!c){c=a.common.dialog.authentication({})}c.show()}};var h=g[d]||g["100001"];return h()||f(d)}});
STK.register("common.dialog.validateCode",function(a){var b=a.lib.kit.extra.language;var c="/ajax/pincode/pin?type=rule&lang=zh-cn&ts=";var d={dialog_html:'<div class="layer_veriyfycode">'+'<div class="v_image"><img height="50" width="450" class="yzm_img" /></div>'+'<p class="v_chng"><a href="#" onclick="return false;" class="yzm_change" action-type="yzm_change">#L{换另一组题目}</a></p>'+'<p class="v_ans_t">#L{请输入上面问题的答案}：</p>'+'<p class="v_ans_i"><input type="text" class="W_inputStp v_inp yzm_input ontext" action-type="yzm_input"/><div class="M_notice_del yzm_error" style="display:none;"><span class="icon_del"></span><span class="txt"></span></div></p>'+'<p class="v_btn">'+'<a class="S_btn_b yzm_submit" href="#" action-type="yzm_submit"><span>#L{确定}</span></a><a class="Sbtn_a yzm_cancel" href="#" action-type="yzm_cancel" action-data="value=frombtn"><span>#L{取消}</span></a>'+"</p>"+"</div>"};var e;return function(){if(e){return e}var f={};var g={};var h;var i;var j;var k;var l=function(){g.yzm_error.innerHTML="";g.yzm_error.parentNode.style.display="none"};var m=function(a){g.yzm_error.innerHTML=a;g.yzm_error.parentNode.style.display=""};var n=function(){if(!h){o()}l();g.input_text.value="";h.show();t.changesrc();h.setMiddle();a.hotKey.add(document.documentElement,["esc"],t.closeDialog,{type:"keyup",disableInInput:true})};var o=function(){h=a.lib.ui.dialog({isHold:true});h.setTitle(b("#L{请输入验证码}"));h.setContent(b(d.dialog_html));var c=h.getOuter();s(c);u()};var p=a.common.trans.validateCode.getTrans("checkAnswer",{onSuccess:function(b,c){var d=b.data.retcode;l();g.input_text.value="";h.hide();var e=i.requestAjax;var f=a.lib.kit.extra.merge(i.param,{retcode:d});e.request(f);j=false},onError:function(){m(b("#L{验证码错误}"));t.changesrc();j=false},onFail:function(){m(b("#L{验证码错误}"));t.changesrc();j=false}});var q=function(){};var r=function(){};var s=function(b){g.vImg=a.core.dom.sizzle("img.yzm_img",b)[0];g.yzm_change=a.core.dom.sizzle("a.yzm_change",b)[0];g.yzm_submit=a.core.dom.sizzle("a.yzm_submit",b)[0];g.yzm_cancel=a.core.dom.sizzle("a.yzm_cancel",b)[0];g.input_text=a.core.dom.sizzle("input.yzm_input",b)[0];g.yzm_error=a.core.dom.sizzle("div.yzm_error span.txt",b)[0];g.close_icon=h.getDom("close")};var t={changesrc:function(){var b=c+a.getUniqueKey();g.vImg.setAttribute("src",b);try{g.yzm_change.blur()}catch(d){}},checkValidateCode:function(){l();var c=a.core.str.trim(g.input_text.value);if(!c){m(b("#L{请输入验证码}"))}else{if(!j){j=true;p.request({secode:c,type:"rule"})}}try{g.yzm_submit.blur()}catch(d){}},closeDialog:function(b){if(typeof b=="object"&&b.el){h.hide()}if(typeof i=="object"&&i.onRelease&&typeof i.onRelease=="function"){i.onRelease()}a.hotKey.remove(document.documentElement,["esc"],t.closeDialog,{type:"keyup"});try{a.preventDefault()}catch(c){}},onFocus:function(b){b=a.core.evt.getEvent();var c=b.target||b.srcElement;var d=c.value;if(!d){l()}}};var u=function(){var b=h.getOuter();k=a.core.evt.delegatedEvent(b);k.add("yzm_change","click",function(){t.changesrc();a.preventDefault()});k.add("yzm_submit","click",function(){t.checkValidateCode();a.preventDefault()});k.add("yzm_cancel","click",t.closeDialog);a.core.evt.addEvent(g.close_icon,"click",t.closeDialog);a.core.evt.addEvent(g.input_text,"focus",t.onFocus);a.core.evt.addEvent(g.input_text,"blur",t.onFocus)};var v=function(){if(h){k.destroy();a.core.evt.removeEvent(g.close_icon,"click",t.closeDialog);a.core.evt.removeEvent(g.input_text,"focus",t.onFocus);a.core.evt.removeEvent(g.input_text,"blur",t.onFocus);h&&h.destroy&&h.destroy()}h=e=null};var w=function(b,c,d){if(b.code=="100027"){i=d;n()}else if(b.code=="100000"){var e=d.onSuccess;e&&e(b,c)}else if(b.code=="100002"){window.location.href=b["data"];return}else if(b.code=="100050"){d.onError(b,c)}else if(b.code=="100004"){a.common.layer.ioError(b.code,c)}else if(b.code==2e7){var f=JSON.parse(b.msg)||{};a.lib.ui.alert(f.msg,{OK:function(){window.location.href=b.data;return}},c.dom).dia.setTitle(f.title)}else{a.lib.ui.alert(b.msg);d.onError(b,c)}};r();r=null;f.destroy=v;f.validateIntercept=w;f.addUnloadEvent=function(){if(h){a.core.evt.addEvent(window,"unload",v)}};e=f;return f}});
STK.register("common.form.follow",function(a){var b={},c,d,e,f,g;var h=a.lib.kit.extra.language,i=a.common.channel.relation;var j=function(b){g||(g=a.common.dialog.setGroup());g.show({groupList:b.groupList,uid:b.uid,fname:b.fname,fnick:b.fnick})};var k=function(){};var l=a.core.dom;var m=function(a,b){l.insertHTML(a,b,"beforebegin");l.removeNode(a)};b.addFollow=function(b){c={fname:"",type:1,uid:"",url:"",el:this,cb:function(){},needGroup:true,wforce:0,"class":"s-btn-c"};d=function(a,b){var c;for(c in b){a[c]=b[c]}return a};c=d(c,b);f=c.el.getAttribute("refer");e={uid:c.uid,type:"followed",action_code:71};if(f){e.Refer=f}var g=c.el.getAttribute("from_weibo")=="1"?"W_btn_b6 W_fr W_mr10":"W_btn_b6";var k=a.common.trans.global;k=k.getTrans("add",{onSuccess:function(a,b){var d=c.el;var e=a.data.relation;if(e.following==1&&e.follow_me==1){m(d,h('<img class="icon_connect" alt="" src="'+$CONFIG.cssPath+'style/images/common/transparent.gif">'))}else{var f=new Array;var g=f.join(",");m(d,h('<a class="'+c.class+'" href="javascript:void(0);" action-type="unUserFollow" uid="'+c.uid+'"><i class="wbicon">Y</i>#L{已关注}</a>'))}i.fire("follow",b);if(c.needGroup){j({groupList:a.data.group,fname:c.fname,uid:c.uid,fnick:a.data.fnick})}c.cb&&c.cb()},onError:function(b,c){if(b.code=="100027"||b.code=="100004"){var d=a.common.dialog.validateCode();d.validateIntercept(b,c,{requestAjax:k,param:c});return}else if(b.code=="40322"||b.code=="20034"){a.lib.ui.confirm($L("#L{您的账号存在高危风险，系统暂时锁定了部分功能。您可以通过验证安全信息的方式，恢复使用。}"),{icon:"warn",OKText:$L("#L{验证安全信息}"),cancelText:$L("#L{以后再验}"),OK:function(){window.location.href="//account.weibo.com/sguide/retrieve?from=sixin"}});return}else if(b.code=="100050"){a.lib.ui.confirm(h(b.msg),{OK:function(){e.wforce=0;k.request(e)}})}else{a.lib.ui.alert(h(b.msg))}}});k.request(e)};b.unFollow=function(b){c={type:1,uid:"",url:"",el:this,cb:function(){}};d=function(a,b){var c;for(c in b){a[c]=b[c]}return a};c=d(c,b);e={uid:c.uid,action_code:72};var f=a.common.trans.global;f=f.getTrans("del",{onSuccess:function(a,b){var d=c.el;if(c.type==1){m(d,h('<a class="W_addbtn" href="javascript:void(0);" action-type="follow" uid="'+c.uid+'"><img class="addicon" alt="" src="'+$CONFIG.cssPath+'style/images/common/transparent.gif">#L{加关注}</a>'))}else{};},onError:function(b,c){var d=a.lib.ui.alert(b.msg,{icon:"error"})}});f.request(e)};return b});
STK.register("common.dialog.loginLayer",function(a){var b;var c="//tjs.sjs.sinajs.cn/t5/register/js/page/remote/loginLayer.js";return function(d){d=a.core.obj.parseParam({lang:"zh-cn",loginSuccessUrl:d.url?d.url:encodeURIComponent(window.location.href),suda:{submitBtn:d.from?"key=tblog_search_v4&value=weibo_nologin2_landing1":"key=tblog_search_v4&value=weibo_nologin2_landing2",registUrl:d.from?"key=tblog_search_v4&value=weibo_nologin2_register1":"key=tblog_search_v4&value=weibo_nologin2_register2"}},d||{});if(window.WBtopGlobal_loginLayer){WBtopGlobal_loginLayer(d)}else{if(b){return}else{b=true;a.core.io.scriptLoader({url:c,onComplete:function(){b=false;window.WBtopGlobal_loginLayer(d)},timeout:1e4,onTimeout:function(){b=false}})}}}});
STK.register("common.trans.live",function(a){var b=a.lib.kit.io.inter();var c=b.register;c("live",{url:"/ajax/aj_find_live.php",method:"get"});c("relative",{url:"/ajax/aj_find_relaSearch.php",method:"get"});c("newfeed",{url:"/Ajax_Search/newtips",method:"get"});c("newLive",{url:"/ajax/mblog/live",method:"get"});return b});
STK.register("common.filter.getNew",function(a){return function(b,c){var d=null;var e={};var f=3e4;var g=true;var h=a.lib.kit.extra.language;var i=a.common.filter.dealUrl;e.start=function(c){var j=a.sizzle("[node-type=feed_list_newBar]",b)[0];if(!j){return}var k=Math.floor((new Date-$CONFIG.timeDiff)/1e3);var l=function(){if(f>90*1e4){e.stop();return}if($CONFIG["islogin"]==="1"){var b=a.common.trans.live.getTrans("newfeed",{onSuccess:function(a){if(a.data.num>0){if(g){j.parentNode.style.display=""}j.innerHTML=h("#L{有}"+" "+a.data.num+" "+"#L{条新微博，点击查看}");f=3e4;g=false}else{f+=1e4}}});b.request({key:decodeURIComponent($CONFIG["s_search"]),t:$CONFIG["servertime"]})}d=window.setTimeout(l,f)};a.core.evt.addEvent(j,"click",function(){var a=window.location.href;a=i.delete_type("rd",a);window.location.href=a+"&rd=newtips";return false})};e.stop=function(){clearTimeout(d);d=null};return e}});
STK.register("lib.kit.extra.rects",function(a){var b=a.core.util.browser;var c={},d=5,e=20;var f={t:function(a,b){return a.t>b.h},b:function(a,b){return a.b>b.h},l:function(a,b){return a.l>b.w},r:function(a,b){return a.r>b.w}};var g={domSize:function(b){var c=a.core.dom.getSize(b);return{w:Math.max(c.width,a.getStyle(b,"width").replace(/px|auto/gi,"")),h:Math.max(c.height,a.getStyle(b,"height").replace(/px|auto/gi,""))}},mouseXY:function(c){var d={x:c.pageX,y:c.pageY};if(b.IE6||b.IE7){var e=a.core.util.scrollPos();d.x=d.x+e.left;d.y=d.y+e.top}return d},getRows:function(a){var c=a.getClientRects();if(b.IE6||b.IE7){var d=[],e={},f;for(var g=0,h=c.length;g<h;g++){var i=c[g];if(!e[i.top]){e[i.top]=[]}e[i.top].push(i)}for(var j in e){var k=e[j];var h=k.length;var l=k[0];if(h>1){l.right=k[h-1].right}d.push(l)}c=d}return c},getTextRect:function(b,c){var d=a.parseParam({evt:""},c);var e=a.core.util.scrollPos(),f;if(!b.getClientRects){var h=g.domSize(b);return{width:h.w,height:h.h,left:"",right:"",top:"",bottom:""}}else{var i={rows:g.getRows(b)};var j=g.mouseXY(d.evt);var k={x:j.x-e.left,y:j.y-e.top};for(var l=0,m=i.rows.length;l<m;l++){var n=i.rows[l];l==0&&(f=n);if(k.y>n.top&&k.y<n.bottom){f=n;break}}if(a.IE){var h=g.domSize(b);f=a.parseParam({width:h.w,height:h.h,left:"",right:"",top:"",bottom:""},f)}return f}},getDistance:function(b,c){var d=a.core.util.winSize(),e=g.getTextRect(b,c);return{win:d,rect:e,w:e.width,h:e.height,t:e.top,l:e.left,r:d.width-e.right,b:d.height-e.bottom}},getSeat:function(b,c,d){var h=a.parseParam({distance:e,priority:"trbl"},d);var i=g.getDistance(b,d),j=g.domSize(c);i["area"]="b";var k=h.priority.split("");for(var l=0,m=k.length;l<m;l++){var n=k[l];if(!!!f[n]){throw'priority error, random use "tbrl" combination'}if(f[n](i,j)){i["area"]=n;break}}return i},setArrow:function(b){var c=a.parseParam({evt:"",node:"",layer:"",arrow:"",priority:"trbl",css_t:"arrow arrow_b",css_r:"arrow arrow_l",css_b:"arrow arrow_t",css_l:"arrow arrow_r",offset:d,distance:e,followNode:false,isFixed:false,setArrowMiddle:false},b);if(!c.node){throw"target node is undefined"}if(!c.layer){throw"layer node is undefined"}if(!c.arrow){throw"arrow node is undefined"}var f=g.getSeat(c.node,c.layer,c);var h=f.area,i=f.rect;c.arrow.className=c["css_"+h];c.arrow.style.cssText="";var j=g.domSize(c.layer);var k=a.scrollPos();if(window.navigator.userAgent.indexOf("iPad")>-1&&window.navigator.userAgent.indexOf("Version/7.0")>-1){k.top=0}var l,m,n;var o=a.winSize().width-20;var p=a.winSize().height-20;var q=j.w;var r=j.h;var s=0;if(c.setArrowMiddle){if(h=="t"||h=="b"){s=parseInt(i.width/2)-d}if(h=="l"||h=="r"){s=parseInt(i.height/2)-d}}if(h=="t"||h=="b"){if(i.left+j.w>o){c.distance=-(o-(i.left+j.w));c.arrow.style.cssText="left:"+c.distance+"px;right:auto;"}if(i.left-c.distance<0){c.distance=c.followNode?0:i.left;c.arrow.style.cssText="left:"+c.distance+"px;right:auto;"}}if(h=="l"||h=="r"){if(i.top+j.h>p){c.distance=-(p-(i.top+j.h));c.arrow.style.cssText="top:"+c.distance+"px;bottom:auto;"}if(i.top-c.distance<0){c.distance=c.followNode?0:i.top;c.arrow.style.cssText="top:"+c.distance+"px;bottom:auto;"}}if(c.isFixed){a.setStyle(c.layer,"position","fixed");k.top=k.left=0}if(h=="t"||h=="b"){l=h=="t"?i.top+k.top-j.h-c.offset:i.bottom+k.top+c.offset;m=i.left+k.left-c.distance+s}else{l=i.top+k.top-c.distance+s;m=h=="r"?i.right+k.left+c.offset:i.left+k.left-j.w-c.offset}c.layer.style.top=l+"px";c.layer.style.left=m+"px";return h},setLevelCardArrow:function(b){var c=a.parseParam({evt:"",node:"",layer:"",arrow:"",priority:"trbl",css_t:"arrow arrow_b",css_r:"arrow arrow_l",css_b:"arrow arrow_t",css_l:"arrow arrow_r",offset:d,distance:e},b);if(!c.node){throw"target node is undefined"}if(!c.layer){throw"layer node is undefined"}if(!c.arrow){throw"arrow node is undefined"}var f=g.getSeat(c.node,c.layer,c);var h=f.area,i=f.rect;c.arrow.className=c["css_"+h];c.arrow.style.cssText="";var j=g.domSize(c.layer),k=a.scrollPos();if(window.navigator.userAgent.indexOf("iPad")>-1&&window.navigator.userAgent.indexOf("Version/7.0")>-1){k.top=0}var l,m,n;var o=a.winSize().width;var p=j.w;if(h=="t"||h=="b"){l=h=="t"?i.top+k.top-j.h-c.offset:i.bottom+k.top+c.offset;m=i.left+k.left-c.distance;n=i.right+k.left-p+c.distance;if(n>0&&m+p>o+k.left){m=n;c.arrow.style.cssText="right:30px;left:auto;"}}else{l=i.top+k.top-c.distance;m=h=="r"?i.right+k.left+c.offset:i.left+k.left-j.w-c.offset}c.layer.style.top=l+"px";c.layer.style.left=m+"px"},setLayer:function(b){var c=a.parseParam({evt:"",node:"",layer:"",priority:"btrl",offsetX:0,offsetY:0},b);if(!c.node){throw"target node is undefined"}if(!c.layer){throw"layer node is undefined"}var d=g.getSeat(c.node,c.layer,c);var e=d.area,f=d.rect;var h=g.domSize(c.layer),i=a.scrollPos();if(window.navigator.userAgent.indexOf("iPad")>-1&&window.navigator.userAgent.indexOf("Version/7.0")>-1){i.top=0}var j,k,l;var m=a.winSize().width;var n=h.w;if(e=="t"||e=="b"){j=e=="t"?f.top+i.top-h.h+c.offsetY:f.bottom+i.top-c.offsetY;k=f.left+i.left+c.offsetX;l=f.right+i.left-n+c.distance;if(l>0&&k+n>m+i.left){k=l}}else{j=f.top+i.top+c.offsetY;k=e=="r"?f.right+i.left-c.offsetX:f.left+i.left-h.w+c.offsetX}c.layer.style.top=j+"px";c.layer.style.left=k+"px"}};c.getTextRect=g.getTextRect;c.getDistance=g.getDistance;c.getSeat=g.getSeat;c.setArrow=g.setArrow;c.setLevelCardArrow=g.setLevelCardArrow;c.setLayer=g.setLayer;return c});
STK.register("lib.kit.dom.layoutPos",function(a){return function(b,c,d){if(!a.isNode(c)){throw"lib.kit.dom.layerOutElement need element as first parameter"}if(c===document.body){return false}if(!c.parentNode){return false}if(c.style.display==="none"){return false}var e,f,g,h,i,j,k;e=a.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},d);f=c;if(!f){return false}while(f!==document.body){f=f.parentNode;if(f.style.display==="none"){return false}j=a.getStyle(f,"position");k=f.getAttribute("layout-shell");if(j==="absolute"||j==="fixed"){break}if(k==="true"&&j==="relative"){break}}f.appendChild(b);g=a.position(c,{parent:f});h={w:c.offsetWidth,h:c.offsetHeight};i=e["pos"].split("-");if(i[0]==="left"){b.style.left=g.l+e.offsetX+"px"}else if(i[0]==="right"){b.style.left=g.l+h.w+e.offsetX+"px"}else if(i[0]==="center"){b.style.left=g.l+h.w/2+e.offsetX+"px"}if(i[1]==="top"){b.style.top=g.t+e.offsetY+"px"}else if(i[1]==="bottom"){if($CONFIG.pageid=="pic"){e.offsetY+=f.scrollTop}b.style.top=g.t+h.h+e.offsetY+"px"}else if(i[1]==="middle"){b.style.top=g.t+h.h/2+e.offsetY+"px"}return true}});
STK.register("pl.feed.card.layer",function(a){var b='<div node-type="outer" class="layer_menu_list" style="display:none;position:absolute;"></div>';return function(c,d){var e,c,f,g,h,i;var j=null;var k=a.lib.kit.dom.layoutPos;var l=a.lib.kit.dom.parseDOM;var m=a.lib.kit.dom.fix;var n=a.lib.kit.dom.drag;var o=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b};var p=function(b,c){c=c||"topleft";var d={};if(b.style.display=="none"){b.style.visibility="hidden";b.style.display="";d=a.core.dom.position(b);b.style.display="none";b.style.visibility="visible"}else{d=a.core.dom.position(b)}var e=o(b);switch(c){case"topleft":break;case"topright":d["l"]=d["l"]+e["w"];break;case"bottomleft":d["t"]=d["t"]+e["h"];break;case"bottomright":d["l"]=d["l"]+e["w"];d["t"]=d["t"]+e["h"];break;default:break}return d};var q={show:function(){if(g&&g.box){h&&h.appendChild(g.box);delete g.box}c.style.display="";a.custEvent.fire(q,"show");return q},hide:function(){c.style.display="none";a.custEvent.fire(q,"hide");return q},getDomList:function(b){if(b){f=l(a.builder(c).list)}return f},getState:function(){if(c.style.display=="none"){return false}else{return true}},getID:function(){return e.id},getBox:function(){return c},getOuter:function(){return c},html:function(a){c.innerHTML="";if(typeof a==="string"){c.innerHTML=a}else{c.appendChild(a)}return q},setTop:function(){c.parentNode&&c.parentNode.appendChild(c);return q},setPosition:function(a){c.style.top=a["t"]+"px";c.style.left=a["l"]+"px";return q},getPosition:function(a){return p(c,a)},setLayoutPos:function(a,b){k(c,a,b);return q},setMiddle:function(){var b=a.core.util.winSize();var d=q.getSize(true);var e=a.core.util.scrollPos()["top"]+(b.height-d.h)/2;c.style.top=(e>0?e:0)+"px";c.style.left=(b.width-d.w)/2+"px";return q},setAlign:function(b){b=a.parseParam({type:"c",offset:[0,0]},b||{});i=m(c,b.type,b.offset);return q},getSize:function(a){if(a||!j){j=o(c)}return j},setIndex:function(a){c.style.zIndex=a},destroy:function(){c.style.display="none";a.removeNode(c);i&&i.destroy();c=null}};var r={init:function(){r.pars();r.build();r.bind()},pars:function(){e=a.parseParam({id:"layer_"+a.core.util.getUniqueKey(),node:null,template:"",appendTo:document.body,draggable:false},d||{});if(a.isNode(c)){e.node=c||e.node}else{switch((typeof c||"").toLowerCase()){case"string":e.id=c||e.id;e.node=a.E(e.id)||null;break;case"object":e=a.parseParam(e,c||{});break}}},build:function(){c=e.node;h=e.appendTo;if(!c){g=a.builder(e.template||b);c=g.list["outer"][0]}else{if(!a.contains(h,c)){h&&h.appendChild(c)}}c.id=e.id;f=l(a.builder(c).list)},bind:function(){a.custEvent.define(q,["show","hide"]);if(e.draggable){n(c,{actObj:c,moveDom:c})}}};r.init();return q}});
STK.register("pl.feed.card.bubble",function(a){return function(b,c){var d='<div class="W_outFrame" node-type="outer" style="position:absolute;">'+'<div class="W_layer">'+'<div class="bg">'+'<table border="0" cellspacing="0" cellpadding="0">'+"<tbody>"+"<tr>"+"<td>"+'<div class="content" node-type="layoutContent">'+'<a class="W_close" href="javascript:void(0);" node-type="close" title="#L{关闭}"></a>'+'<div node-type="inner"></div>'+"</div>"+"</td>"+"</tr>"+"</tbody>"+"</table>"+'<div class="arrow arrow_t" node-type="arrow"></div>'+"</div>"+"</div>"+"</div>";var e,f,g,h,i,j,k;var l;var m=false;var n=a.pl.feed.card.layer;var o=function(b){if(m){return true}var c=a.fixEvent(b);if(!a.contains(g,c.target)){e.hide()}};var p={init:function(){p.pars();p.build();p.bind()},pars:function(){if(!c){c={}}c.template=c.template||d},build:function(){e=n(b,c);k=a.objSup(e,["setLayoutPos","destroy"]);g=e.getBox();f=a.builder(g).list;h=f["inner"][0];f["close"][0]&&(i=f["close"][0]);f["arrow"][0]&&(j=f["arrow"][0])},bind:function(){if(i){a.addEvent(i,"click",e.hide)}a.custEvent.add(e,"show",function(){setTimeout(function(){a.addEvent(document.body,"click",o)},0)});a.custEvent.add(e,"hide",function(){m=false;a.removeEvent(document.body,"click",o)})}};p.init();l=e;l.setLayoutPos=function(b,c){if(!a.isNode(b)){a.log("ui.bubble.setLayoutPos need element as target")}j&&(j.style.cssText="");k.setLayoutPos(b,c);return l};l.setAlignPos=function(b,c,d){d=a.parseParam({offset:{left:0,top:0},arrowOffset:0,align:"left",fail:a.funcEmpty},d);if(!a.isNode(b)||!a.isNode(c)){return}var e=b,f;while(e!==document.body){e=e.parentNode;f=a.getStyle(e,"position");if(f==="absolute"){break}}e.appendChild(g);f=a.position(e);if(!f){f={l:0,t:0}}var h=a.core.dom.getSize;var i=a.position(c);var k=a.position(b);var m=h(b);var n=6,o=14;var p,q,r;var s=d.offset;var t=d.arrowOffset;var u=h(g);var v=h(c);var w=2;if(d.align==="left"){if(u.width<k.l-i.l+Math.ceil(m.width/2)){d.fail();return}}else{if(i.l+v.width-k.l-Math.ceil(m.width/2)>u.width){d.fail();return}}if(d.align==="left"){p=i.l-w}else{p=i.l+v.width-u.width+w}q=k.t+m.height+n;r=k.l+Math.ceil((m.width-o)/2)-p;q-=f.t;p-=f.l;q+=s.top;p+=s.left;r+=t;g.style.left=p+"px";g.style.top=q+"px";j&&(j.style.left=r+"px");return l};l.setContent=function(b){h.innerHTML="";if(typeof b==="string"){h.innerHTML=b}else if(a.isNode(b)){h.appendChild(b)}return l};l.clearContent=function(){h.innerHTML="";return l};l.setArrow=function(a){if(j){if(a["className"]){j.className=a["className"]||"arrow arrow_t"}if(a["style"]){j.style.cssText=a["style"]||""}}return l};l.stopBoxClose=function(){m=true;return l};l.startBoxClose=function(){m=false;return l};l.getClose=function(){return i};l.destroy=function(){a.removeEvent(document.body,"click",o);k.destroy();e=null};return l}});
STK.register("pl.feed.card.positioncard",function(a){return function(b){var c=a.lib.kit.extra.rects;var d=a.lib.kit.extra.merge;var e=a.parseParam({priority:"tbrl"},b);var f=a.pl.feed.card.bubble;var g=f(b).hide();var h=a.builder(g.getBox()).list;g.setPriority=function(a){e.priority=a};g.showByTarget=function(a,b){b=b||{};if(b.priority){g.setPriority(b.priority)}setTimeout(function(){g.show();var f=d({node:a,layer:g.getBox(),arrow:h["arrow"][0],priority:e.priority},b);c.setArrow(f)},0)};return g}});
STK.register("pl.feed.card.card",function(a){var b=500;var c=200;var d=a.lib.kit.extra.rects;var e=a.pl.feed.card.positioncard;return function(d,f){var g={};var h;var i;var j;var k=false;var l=a.parseParam({autoShow:true,autoHide:true,attribute:"usercard",out:document.body},f);var m=e(f);m.setContent('<div style="width:300px;height:120px;padding:10px;"></div>');var n=function(a,b){if(a.type!="mouseout"&&a.type!="mouseover"){return false}var c=a.relatedTarget?a.relatedTarget:a.type=="mouseout"?a.toElement:a.fromElement;while(c&&c!=b){c=c.parentNode}return c!=b};var o=function(c,d){clearTimeout(j);j=setTimeout(function(){a.custEvent.fire(g,"beforeShow",[c,d]);if(l.autoShow){m.showByTarget(c,d);a.custEvent.fire(g,"show",[c,d])}},b)};var p=function(){if(k==false){return}clearTimeout(j);j=setTimeout(function(){a.custEvent.fire(g,"beforeHide");if(l.autoHide){m.hide();a.custEvent.fire(g,"hide")}},c)};a.custEvent.define(g,["beforeShow","show","beforeHide","hide"]);var q=function(){k=true};var r=function(){k=false};var s=function(b){var c=a.fixEvent(window.event).target;i=c;if(h==c){return}if(a.contains(m.getBox(),c)){clearTimeout(j);return}var d=c.getAttribute(l.attribute);if(d){o(c,{evt:b})}else{p()}h=c};var t=function(a){if(n(a||window.event,m.getBox())){clearTimeout(j)}};var u=function(a){if(n(a||window.event,m.getBox())){p()}};var v=function(){a.addEvent(l.out,"mousemove",s);a.addEvent(m.getBox(),"mouseover",t);a.addEvent(m.getBox(),"mouseout",u);a.custEvent.add(m,"show",q);a.custEvent.add(m,"hide",r)};var w=function(){v()};var x=function(){a.removeEvent(out,"mousemove",t);a.removeEvent(m.getBox(),"mouseover",t);a.removeEvent(m.getBox(),"mouseout",u);a.custEvent.remove(m,"show",q);a.custEvent.remove(m,"hide",r);m.destroy()};w();g.card=m;g.attribute=l.attribute;g.mouseTarget=function(){return i};g.isShowCard=function(){return k};g.showCard=o;g.hideCard=p;g.destroy=x;return g}});
STK.register("pl.feed.basecard",function(a){var b='<div style="width:360px;padding-top:15px;padding-bottom:15px;text-align:center">'+"<span>#{msg}</span>"+"</div>";var c='<div class="W_loading" style="width:360px;padding-top:15px;padding-bottom:15px;text-align:center">'+"<span>#L{正在加载，请稍候}...</span>"+"</div>";var d={userCard:{url:"http://weibo.com/aj/user/newcard",method:"get",requestMode:"jsonp",varkey:"callback"},userCard_abroad:{url:"http://www.weibo.com/aj/user/newcard",method:"get",requestMode:"jsonp",varkey:"callback"}};var e=5*60*1e3;return function(f,g){var h={};var i=a.lib.kit.extra.language;var j=a.pl.feed.card.card;g=g||{};g.autoShow=false;var k=j(g);var l=k.card;var m=l.getBox();var n={};var o=a.parseParam({trans:d,transName:"userCard",temp_error:i(b),temp_loading:i(c),cacheDelay:e,zIndex:"99999",extraData:""},g);var p;var q;var r;var s;var t;var u;var v;var w;var x=500;var y=function(a,b){if(n[a]&&n[a][b]){return n[a][b]}else{return null}};var z=function(a,b,c){if(!n[a]){n[a]={}}n[a][b]=c;return c};var A=function(a){if(a){n[a]={}}else{n={}}};var B=function(b,c){var c=a.parseParam({success:a.funcEmpty,fail:a.funcEmpty},c);var d=b.getAttribute(k.attribute)||"";console.log(d);var e=a.queryToJson(d);var f=e.id||e.name;if(e.name){e.name=encodeURIComponent(e.name)}if(e.type==undefined){e.type=1}var g=e.type;var h=y(f,g);console.log(e);if(h){c.success(b,h);return}console.log(o);o.trans.request(o.transName,{onComplete:function(a){console.log(a);if(a.code=="100000"){c.success(b,z(f,g,a.data))}else{c.fail(b,a.msg)}}},$merge(e,a.queryToJson(o.extraData)))};var w;var x=500;var C=function(b,c,d){t=c;var e=function(){var b=k.mouseTarget();return t==c&&a.contains(document.body,c)&&(b==c||a.contains(m,b))}();var f=false;w=setTimeout(function(){if(e){l.setContent(o.temp_loading).showByTarget(c,d);f=true}},x);console.log(1);B(c,{success:function(a,b){clearTimeout(w);setTimeout(function(){if(e){l.setContent(b).showByTarget(a,d);f=false;D()}},f?1e3:0)},fail:function(a,b){var c,g;clearTimeout(w);setTimeout(function(){if(e){g={msg:b||i("#L{加载失败}")};c=$T(o.temp_error,g);l.setContent(c).showByTarget(a,d);f=false}},f?x:0)}})};var D=function(){if(r){E()}var b=a.builder(m).list;b.morelist&&(r=$hover({act:b.followBtnBox[0],delay:0,moutDelay:500,extra:[b.morelist[0]],onmouseover:function(){b.morelist[0].style.display="";var c=a.position(b.followBtnBox[0]);var d=a.core.dom.getSize(b.followBtnBox[0]);a.setXY(b.morelist[0],{t:c.t+d.height+2,l:c.l})},onmouseout:function(){b.morelist[0].style.display="none"}}))};var E=function(){if(r){r.destroy();r=null}};var F={};var G=function(){H();I();J();K()};var H=function(){if(!f)throw"path : pl.feed.usercard"};var I=function(){};var J=function(){q=a.builder(m).list;q["close"][0].style.display="none";m.style.zIndex=o.zIndex;console.log(21)};var K=function(){p=a.delegatedEvent(m);a.custEvent.add(k,"beforeShow",C);s=setInterval(A,e)};var L=function(){};G();h.destory=L;return h}});
STK.register("pl.feed.usercard",function(a){var b='<div class="W_outFrame" node-type="outer" style="position:absolute;display:none;-webkit-transform:translate3d(0,0,0);">'+'<div class="W_layer" style="position: static;">'+'<div class="bg">'+'<table border="0" cellspacing="0" cellpadding="0">'+'<tbody><tr><td><div class="content" node-type="layoutContent">'+'<a class="W_close" href="javascript:void(0);" node-type="close" title="#L{关闭}"></a>'+'<div class="layer_personcard" node-type="inner"></div>'+"</div></td></tr></tbody>"+"</table>"+'<div class="arrow arrow_t" node-type="arrow"></div>'+"</div>"+"</div>"+"</div>";var c=document.domain==="www.weibo.com";return function(d,e){var f={};var g=a.pl.feed.basecard;var h=g({template:b,transName:c?"userCard_abroad":"userCard",priority:"trlb"});var i=h.devt;var j=h.usercard.card;var k=j.getBox();var l,m;var n={};var o=function(){p();q();r();s()};var p=function(){if(!d)throw"path : pl.feed.usercard"};var q=function(){nodes=a.lib.kit.dom.parseDOM(a.builder(d).list)};var r=function(){};var s=function(){var b=a.core.evt.delegatedEvent(d)};var t=function(){};o();f.destory=t;return f}});
STK.register("pl.common.common",function(a){var b="pl.common.common";return function(b,c){var d={};var e,f,g;var h={login:function(){var b={lang:"zh-cn"};a.preventDefault();a.common.dialog.loginLayer(b)},userFollow:function(b){var b=b.el;a.common.form.follow.addFollow({uid:b.getAttribute("uid"),el:b,"class":b.getAttribute("class")})},topicFollow:function(a){a.el.style.display="none";a.el.nextElementSibling.style.display="inline-block"},backgroundpos:function(b){var c=a.core.util.scrollPos()["top"];if(c>90){document.body.style.backgroundPosition="center top";document.body.style.backgroundRepeat="repeat"}else{document.body.style.backgroundPosition="center 140px";document.body.style.backgroundRepeat="repeat-x"}},showPageMoreList:function(a){var b=f["pageMoreList"];if(a.evt.type=="mouseout"){e=setTimeout(function(){b.style.display="none"},400)}else{clearTimeout(e);b.style.display=""}},rollNews:function(){var c=a.sizzle(".card-hoting ul",b)[0],d=a.sizzle(".card-hoting li",b),e=d[0].offsetHeight;c.style.cssText="position:relative;top:0;";var f=a.core.ani.tween(c,{end:function(a){var b=d[0].cloneNode(true);c.removeChild(d[0]);c.style.top=0;c.appendChild(b)},animationType:"easeinoutback",duration:300,extra:0});f.play({top:-e}).destroy()}};var i=function(){j();k();l();m()};var j=function(){if(!b)throw"path : pl.feed.common"};var k=function(){f={pageMoreList:a.sizzle("[node-type=feed_list_page_morelist]",b)[0]}};var l=function(){a.common.filter.getNew(b).start();h.backgroundpos();if(a.sizzle(".card-hoting",b).length&&a.sizzle(".card-hoting li",b).length>1){setInterval(h.rollNews,3e3)}};var m=function(){var c=a.core.evt.delegatedEvent(b);c.add("login","click",h.login);c.add("userFollow","click",h.userFollow);c.add("topicFollow","click",h.topicFollow);c.add("feed_list_page_more","mouseover",h.showPageMoreList);c.add("feed_list_page_more","mouseout",h.showPageMoreList);c.add("feed_list_page_morelist","mouseover",h.showPageMoreList);c.add("feed_list_page_morelist","mouseout",h.showPageMoreList);a.core.evt.addEvent(window,"scroll",h.backgroundpos)};var n=function(){var b=a.core.evt.delegatedEvent(f.searchItems);b.remove("login","click");b.remove("userFollow","click");a.core.evt.removeEvent(window,"scroll",h.backgroundpos)};i();d.destory=n;return d}});
STK.pageletM.register("pl.common.main",function(a){var b=a.E("pl_feed_main");if(b){return a.pl.common.common(b)}});
;
